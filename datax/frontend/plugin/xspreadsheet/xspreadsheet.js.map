{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/local/base/element.ts","webpack:///./src/local/event.ts","webpack:///./src/core/cell.ts","webpack:///./src/local/base/item.ts","webpack:///./src/local/base/icon.ts","webpack:///./src/local/base/menu.ts","webpack:///./src/core/format.ts","webpack:///./src/core/formula.ts","webpack:///./src/core/alphabet.ts","webpack:///./src/main.ts","webpack:///./src/local/index.ts","webpack:///./src/core/index.ts","webpack:///./src/core/font.ts","webpack:///./src/core/select.ts","webpack:///./src/style/index.less?de79","webpack:///./src/style/index.less","webpack:///./node_modules/css-loader/lib/url/escape.js","webpack:///./node_modules/css-loader/lib/css-base.js","webpack:///./src/assets/sprite.svg","webpack:///./node_modules/style-loader/lib/addStyles.js","webpack:///./node_modules/style-loader/lib/urls.js","webpack:///./src/local/table.ts","webpack:///./src/local/editor.ts","webpack:///./src/local/base/suggest.ts","webpack:///./src/local/selector.ts","webpack:///./src/local/resizer.ts","webpack:///./src/local/contextmenu.ts","webpack:///./src/local/toolbar.ts","webpack:///./src/local/base/dropdown.ts","webpack:///./src/local/base/colorPanel.ts","webpack:///./src/local/editorbar.ts"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","event_1","Element","[object Object]","tag","this","_data","_clickOutside","el","document","createElement","undefined","eventName","handler","first","others","split","addEventListener","evt","k","console","log","button","stopPropagation","cb","parentNode","className","map","keys","attr","getAttribute","setAttribute","removeAttribute","offsetTop","offsetLeft","offsetHeight","offsetWidth","top","left","height","width","style","isClear","clearStyle","getPropertyValue","setProperty","contains","removeProperty","cs","child","appendChild","createTextNode","HTMLElement","html","innerHTML","v","cloneNode","isHide","show","hide","addClass","removeClass","flag","deactive","hasClass","cls","concat","join","filter","indexOf","isRemove","removeStyle","data","target","unbind","setTimeout","h","fn","window","removeEventListener","mouseMoveUp","movefunc","upfunc","up","defaultCell","font","format","fontSize","bold","italic","underline","color","backgroundColor","align","valign","wordWrap","invisible","rowspan","colspan","text","getStyleFromCell","cell","element_1","icon_1","Item","super","iconEl","class","buildIcon","replace","buildItem","Icon","img","Menu","buildMenu","formatRenderHtml","txt","formats","length","render","formatNumberRender","test","parts","Number","toFixed","toString","formatRender","title","label","alphabet_1","formulaFilterKey","fx","substring","formula","formulas","toLowerCase","lastIndexOf","formulaRender","renderCell","param","formulaParamToArray","formulaReplaceParam","rowDiff","colDiff","params","replaceFormula","_v","trim","idx","exec","vc","index","vr","parseInt","alphabet","alphabetIndex","paramValues","min","max","maxIdx","minC","minR","maxC","maxR","push","eval","e","vv","reduce","a","b","Math","_alphabet","ret","cindex","charCodeAt","index_1","xspreadsheet","options","LocalSpreadsheet","default","table_1","toolbar_1","editorbar_1","refs","toolbar","editorbar","_change","bindEl","assign","ss","Spreadsheet","Editorbar","change","editorbarChange","Toolbar","toolbarChange","undo","table","redo","Table","documentElement","clientHeight","setRedoAble","isRedo","setUndoAble","isUndo","editorChange","clickCell","rindex","reload","children","setCellAttr","copyformat","clearformat","merge","setValueWithText","setValue","cols","set","td","format_1","font_1","formula_1","cell_1","select_1","History","type","values","oldValue","histories","histories2","currentCellIndexes","select","copySelect","cutSelect","fonts","rowHeight","colWidth","prop","startTarget","endTarget","startAttrs","getElementAttrs","endAttrs","sRow","row","sCol","col","eRow","eCol","minRow","maxRow","calcMinï¼­axRow","getCell","minCol","maxCol","calcMinMaxCol","minr","maxr","minc","maxc","firstCell","canotMerge","Select","state","clear","cselect","history","forEach","j","srcRowIndex","rowIndex","srcColIndex","colIndex","oldCell","newCell","copyCell","add","destRowIndex","start","destColIndex","amount","cells","srindex","scindex","newCells","key1","arrow","startRow","startCol","stopRow","stopCol","seqCopy","oldDestCell","destCell","srcCell","m1","m2","pop","resetByHistory","nValue","mapIntFilter","ok","cancel","other","cellLen","firstXY","canMerge","isDefault","indexes","isCopy","it","rows","isData","mapIntMaxKey","mapIntMaxKeyWithDefault","range","mapInt","obj","stop","cCol","dcell","cColspan","cRow","cRowspan","sx","sy","ex","ey","rowLen","colLen","content","hmr","transform","insertInto","locals","escape","url","slice","useSourceMap","list","item","cssMapping","btoa","sourceMapping","sourceMap","unescape","encodeURIComponent","JSON","stringify","toComment","sourceURLs","sources","source","sourceRoot","cssWithMappingToString","mediaQuery","alreadyImportedModules","id","stylesInDom","isOldIE","memo","apply","arguments","memoize","all","atob","getElement","styleTarget","querySelector","HTMLIFrameElement","contentDocument","head","singleton","singletonCounter","stylesInsertedAtTop","fixUrls","addStylesToDom","styles","domStyle","addStyle","listToStyles","newStyles","base","part","css","media","insertStyleElement","Error","lastStyleElementInsertedAtTop","insertAt","nextSibling","insertBefore","firstChild","before","removeStyleElement","removeChild","splice","createStyleElement","attrs","addAttrs","update","remove","result","styleIndex","applyToSingletonTag","URL","createObjectURL","revokeObjectURL","Blob","link","rel","createLinkElement","autoFixUrls","convertToAbsoluteUrls","blob","oldSrc","href","styleSheet","cssText","newObj","DEBUG","newList","mayRemove","replaceText","textStore","replacement","Boolean","cssNode","childNodes","location","baseUrl","protocol","host","currentDir","pathname","fullMatch","origUrl","newUrl","unquotedOrigUrl","$1","editor_1","selector_1","resizer_1","contextmenu_1","firsttds","tds","ths","formulaCellIndexs","Set","fixedLeftBody","editor","rowResizer","colResizer","contextmenu","currentIndexs","focusing","Editor","defaultRowHeight","Resizer","distance","changeRowResizer","changeColResizer","ContextMenu","selector","Selector","selectorChange","changeCopy","selectorChangeCopy","dashedSelector","DashedSelector","buildFixedLeft","header","buildHeader","body","buildBody","on","returnValue","preventDefault","parent","ctrlKey","keyCode","copy","cut","paste","moveLeft","moveUp","moveRight","moveDown","cellText","currentCell","moveSelector","direction","setCurrentTarget","bodyWidth","bodyHeight","offset","leftDiff","scrollLeft","scrollTop","mousedownCell","autoWordWrap","setTdStyles","setRowHeight","cellAttr","setTdWithCell","setStyle","setTdStylesAndAttrsAndText","setTdAttrs","removeAttr","insert","batchPaste","setKey","has","delete","reRenderFormulaCells","_renderCell","rcindexes","tdRowspan","changeRowHeight","firstTds","w","lastColWidth","firstTd","firsttdsPush","thead","th","buildColGroup","editorValue","_rindex","_cindex","_cell","cCell","mousedown","dblclick","editCell","tbody","num","suggest_1","suggestList","textarea","inputKeydown","inputChange","textline","visibility","overflow","position","suggest","Suggest","itemClick","val","setTextareaRange","setSelectionRange","focus","autocomplete","includes","search","ow","maxWidth","clientWidth","item_1","menu_1","filterList","currentIndex","evtTarget","hideAndRemoveEvents","active","click","removeEvents","input","word","lis","startsWith","toUpperCase","clickItemHandler","documentHandler","documentKeydownHandler","_offset","topEl","rightEl","bottomEl","leftEl","areaEl","cornerEl","cornerMousedown","copyEl","detail","shiftKey","setOffset","buttons","boxRange","rdiff","cdiff","_rdiff","_cdiff","rowsHeight","abs","colsWidth","_forEach","buildSelect","elements","es","vertical","moving","resizer","resizerLine","scroll","startEvt","x","y","onClickOutside","elRect","getBoundingClientRect","offsetY","offsetX","clientY","clientX","dropdown_1","colorPanel_1","elUndo","buildUndo","elRedo","buildRedo","elPaintformat","buildPaintformat","elClearformat","buildClearformat","elFormat","buildFormats","buildSeparator","elFont","buildFonts","elFontSize","buildFontSizes","elFontWeight","buildFontWeight","elFontStyle","buildFontStyle","elTextDecoration","buildTextDecoration","elColor","buildColor","elBackgroundColor","buildBackgroundColor","elMerge","buildMerge","elAlign","buildAligns","elValign","buildValigns","elWordWrap","buildWordWrap","setCell","setCellStyle","getFormat","getFont","able","disabled","titleIcon","clickHandler","buildDropdown","buildIconItem","is","border-bottom","margin-top","buildColorPanel","iconName","isActive","Dropdown","contentChildren","toggleHandler","colorss","ColorPanel","colors"],"mappings":"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","file":"xspreadsheet.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 9);\n","import { bind, unbind } from '../event'\n\nexport class Element {\n  el: HTMLElement;\n  _data: {[key: string]: any} = {};\n  _clickOutside: any = null;\n\n  constructor (public tag = 'div') {\n    this.el = document.createElement(tag)\n  }\n\n  data (key: string, value?: any) {\n    if (value !== undefined) {\n      this._data[key] = value\n    }\n    return this._data[key]\n  }\n\n  on (eventName: string, handler: (evt: any) => any): Element {\n    const [first, ...others] = eventName.split('.')\n    // console.log('first:', first, ', others:', others)\n    this.el.addEventListener(first, (evt: any) => {\n      // console.log('>>>', others, evt.button)\n      for (let k of others) {\n        console.log('::::::::::', k)\n        if (k === 'left' && evt.button !== 0) {\n          return\n        } else if (k === 'right' && evt.button !== 2) {\n          return\n        } else if (k === 'stop') {\n          evt.stopPropagation()\n        }\n      }\n      // console.log('>>>>>>>>>>>>')\n      handler(evt)\n    })\n    return this;\n  }\n\n  onClickOutside (cb: () => void): Element {\n    this._clickOutside = cb\n    return this;\n  }\n\n  parent(): any {\n    return this.el.parentNode\n  }\n\n  class (name: string): Element {\n    this.el.className = name\n    return this;\n  }\n\n  attrs (map: {[key: string]: string} = {}): Element {\n    for (let key of Object.keys(map))\n      this.attr(key, map[key]);\n    return this;\n  }\n\n  attr (attr: string, value?: any): any {\n    if (value !== undefined) {\n      this.el.setAttribute(attr, value);\n    } else {\n      return this.el.getAttribute(attr)\n    }\n    return this;\n  }\n  removeAttr(attr: string): Element {\n    this.el.removeAttribute(attr);\n    return this;\n  }\n\n  offset (): any {\n    const { offsetTop, offsetLeft, offsetHeight, offsetWidth } = this.el\n    return {top: offsetTop, left: offsetLeft, height: offsetHeight, width: offsetWidth}\n  }\n\n  clearStyle () {\n    (<any>this.el).style = ''\n    return this;\n  }\n\n  styles (map: {[key: string]: string} = {}, isClear = false): Element {\n    if (isClear) {\n      this.clearStyle()\n    }\n    for (let key of Object.keys(map))\n      this.style(key, map[key]);\n    return this;\n  }\n\n  style (key: string, value?: any): any {\n    if (value !== undefined) {\n      this.el.style.setProperty(key, value);\n    } else {\n      return this.el.style.getPropertyValue(key)\n    }\n    return this;\n  }\n\n  contains (el: any) {\n    return this.el.contains(el)\n  }\n\n  removeStyle (key: string) {\n    this.el.style.removeProperty(key)\n    return ;\n  }\n\n  children (cs: Array<HTMLElement | string | Element>): Element {\n    for (let c of cs)\n      this.child(c);\n    return this;\n  }\n\n  child (c: HTMLElement | string | Element): Element {\n    if (typeof c === 'string') {\n      this.el.appendChild(document.createTextNode(c))\n    } else if (c instanceof Element) {\n      this.el.appendChild(c.el)\n    } else if (c instanceof HTMLElement) {\n      this.el.appendChild(c)\n    }\n    return this;\n  }\n\n  html (html?: string) {\n    if (html !== undefined) {\n      this.el.innerHTML = html\n    } else {\n      return this.el.innerHTML\n    }\n    return this;\n  }\n\n  val (v?: string) {\n    if (v !== undefined) {\n      // (<any>this.el).value = v\n      (<any>this.el).value = v\n    } else {\n      return (<any>this.el).value\n    }\n    return this;\n  }\n\n  clone (): any {\n    return this.el.cloneNode();\n  }\n\n  isHide () {\n    return this.style('display') === 'none'\n  }\n\n  toggle () {\n    if (this.isHide()) {\n      this.show()\n    } else {\n      this.hide()\n    }\n  }\n\n  disabled (): Element {\n    // this.removeClass('disabled')\n    this.addClass('disabled')\n    return this;\n  }\n  able (): Element {\n    this.removeClass('disabled')\n    return this;\n  }\n\n  active (flag = true): Element {\n    // this.el.className = this.el.className.split(' ').filter(c => c !== 'disabled').join(' ') + ' active'\n    // this.removeClass('disabled')\n    if (flag)\n      this.addClass('active')\n    else\n      this.deactive()\n    return this;\n  }\n  deactive (): Element {\n    return this.removeClass('active')\n  }\n  isActive (): boolean {\n    return this.hasClass('active');\n  }\n\n  addClass (cls: string): Element {\n    this.el.className = this.el.className.split(' ').concat(cls).join(' ')\n    return this;\n  }\n  removeClass (cls: string) {\n    // console.log('before.className: ', this.el.className)\n    this.el.className = this.el.className.split(' ').filter(c => c !== cls).join(' ')\n    // console.log('after.className: ', this.el.className)\n    return this;\n  }\n  hasClass (cls: string) {\n    return this.el.className.indexOf(cls) !== -1\n  }\n\n  show (isRemove = false): Element {\n    isRemove ? this.removeStyle('display') : this.style('display', 'block');\n    // clickoutside\n    if (this._clickOutside) {\n      this.data('_outsidehandler', (evt: Event) => {\n        if (this.contains(evt.target)) {\n          return false\n        }\n        this.hide()\n        unbind('click', this.data('_outsidehandler'))\n        this._clickOutside && this._clickOutside()\n      })\n      setTimeout(() => {\n        bind('click', this.data('_outsidehandler'))\n      }, 0)\n    }\n    return this;\n  }\n\n  hide (): Element {\n    this.style('display', 'none');\n    if (this._clickOutside) {\n      unbind('click', this.data('_outsidehandler'))\n    }\n    return this;\n  }\n}\n\nexport function h (tag = 'div'): Element {\n  return new Element(tag)\n}","export function bind<T extends Event>(name: string, fn: (evt: T) => void, target: any = window) {\n  target.addEventListener(name, fn)\n}\nexport function unbind<T extends Event>(name: string, fn: (evt: T) => void, target: any = window) {\n  target.removeEventListener(name, fn)\n}\nexport function mouseMoveUp<T extends Event> (movefunc: (evt: T) => void, upfunc: (evt: T) => void) {\n  bind('mousemove', movefunc)\n  const up = (evt: T) => {\n    unbind('mousemove', movefunc)\n    unbind('mouseup', up)\n    upfunc(evt)\n  }\n  bind('mouseup', up)\n}","export interface Cell {\n  font?: string;\n  format?: string;\n  fontSize?: number;\n  bold?: boolean;\n  italic?: boolean;\n  underline?: boolean;\n  color?: string;\n  backgroundColor?: string;\n  align?: string;\n  valign?: string;\n  wordWrap?: boolean;\n  visable?: boolean;\n  rowspan?: number;\n  colspan?: number;\n  text?: string;\n  merge?: [number, number];\n  [key: string]: any\n}\n\nexport const defaultCell: Cell = {\n  font: 'Microsoft YaHei',\n  format: 'normal',\n  fontSize: 14,\n  bold: false,\n  italic: false,\n  underline: false,\n  color: '#333',\n  backgroundColor: '#fff',\n  align: 'left',\n  valign: 'middle',\n  wordWrap: false,\n  invisible: false,\n  rowspan: 1,\n  colspan: 1,\n  text: '',\n\n}\n\nexport function getStyleFromCell (cell: Cell | null): {[key: string]: string} {\n  const map: {[key: string]: string} = {}\n  if (cell) {\n    if (cell.font) map['font-family'] = cell.font\n    if (cell.fontSize) map['font-size'] = `${cell.fontSize}px`\n    if (cell.bold) map['font-weight'] = 'bold'\n    if (cell.italic) map['font-style'] = 'italic'\n    if (cell.underline) map['text-decoration'] = 'underline'\n    if (cell.color) map['color'] = cell.color\n    if (cell.backgroundColor) map['background-color'] = cell.backgroundColor\n    if (cell.align) map['text-align'] = cell.align\n    if (cell.valign) map['vertical-align'] = cell.valign\n    if (cell.invisible) {\n      map['display'] = 'none'\n    }\n    if (cell.wordWrap) {\n      map['word-wrap'] = 'break-word'\n      map['white-space'] = 'normal'\n    }\n  }\n  return map\n}\n","import { Element } from \"./element\";\nimport { Icon, buildIcon } from \"./icon\";\n\nexport class Item extends Element {\n\n  iconEl: Icon | null = null;\n\n  static build (): Item {\n    return new Item()\n  }\n  \n  constructor () {\n    super();\n    this.class('spreadsheet-item');\n  }\n\n  icon (name: string) {\n    this.child(this.iconEl = buildIcon(name))\n    return this;\n  }\n\n  replaceIcon (name: string) {\n    this.iconEl && this.iconEl.replace(name)\n  }\n\n}\n\nexport function buildItem (): Item {\n  return new Item();\n}","import { Element, h } from \"./element\";\n\nexport class Icon extends Element{\n\n  img: Element;\n\n  constructor (name: string) {\n    super();\n    this.class('spreadsheet-icon').child(this.img = h().class(`spreadsheet-icon-img ${name}`));\n  }\n\n  replace (name: string) {\n    this.img.class(`spreadsheet-icon-img ${name}`)\n  }\n\n}\n\nexport function buildIcon (name: string) {\n  return new Icon(name);\n}","import { Element } from \"./element\";\n\nexport class Menu extends Element{\n\n  constructor (align = 'vertical') {\n    super();\n    this.class(`spreadsheet-menu ${align}`)\n  }\n\n}\n\nexport function buildMenu (align = 'vertical') {\n  return new Menu(align);\n}","export interface Format {\n  key: string;\n  title: string;\n  label?: string;\n  render(txt: string): string;\n}\nexport const formatRenderHtml = (key: string | undefined, txt: string | undefined) => {\n  for (let i = 0; i < formats.length; i++) {\n    if (formats[i].key === key) {\n      return formats[i].render(txt || '')\n    }\n  }\n  return txt || ''\n}\n\nconst formatNumberRender = (v: string) => {\n  if (/^(-?\\d*.?\\d*)$/.test(v)) {\n    v = Number(v).toFixed(2).toString()\n    const parts = v.split('.')\n    parts[0] = parts[0].toString().replace(/(\\d)(?=(\\d{3})+(?!\\d))/g, '$1' + ',')\n    return parts.join('.')\n  }\n  return v\n}\n\nconst formatRender = (v: string) => v\n\nexport const formats: Array<Format> = [\n  {key: 'normal', title: 'Normal', render: formatRender},\n  {key: 'text', title: 'Text', render: formatRender},\n  {key: 'number', title: 'Number', label: '1,000.12', render: formatNumberRender},\n  {key: 'percent', title: 'Percent', label: '10.12%', render: (v) => `${formatNumberRender(v)}%`},\n  {key: 'RMB', title: 'RMB', label: 'ï¿¥10.00', render: (v) => `ï¿¥${formatNumberRender(v)}`},\n  {key: 'USD', title: 'USD', label: '$10.00', render: (v) => `$${formatNumberRender(v)}`}\n]","import { alphabetIndex, alphabet } from \"./alphabet\";\n\nexport interface Formula {\n  key: string;\n  title: string;\n  render(ary: Array<number>): number\n}\n\nexport const formulaFilterKey = (v: string, filter: (formula: Formula, param: string) => string) => {\n  if (v[0] === '=') {\n    const fx = v.substring(1, v.indexOf('('))\n    for (let formula of formulas) {\n      if (formula.key.toLowerCase() === fx.toLowerCase()) {\n        return filter(formula, v.substring(v.indexOf('(') + 1, v.lastIndexOf(')')))\n      }\n    }\n  }\n  return v\n}\n\nexport const formulaRender = (v: string, renderCell: (rindex: number, cindex: number) => any) => {\n  return formulaFilterKey(v, (fx, param) => {\n    return fx.render(formulaParamToArray(param, renderCell)) + '';\n  })\n}\n\nexport const formulaReplaceParam = (param: string, rowDiff: number, colDiff: number): string => {\n  return formulaFilterKey(param, (fx, params) => {\n    const replaceFormula = (_v: string):string => {\n      if (/^[0-9\\-\\+\\*\\/()\\s]+$/.test(_v.trim())) {\n        return _v\n      }\n      const idx = /\\d+/.exec(_v)\n      if (idx) {\n        let vc = _v.substring(0, idx.index).trim()\n        let vr = parseInt(_v.substring(idx.index).trim())\n        return `${alphabet(alphabetIndex(vc) + colDiff)}${vr + rowDiff}`\n      }\n      return _v;\n    }\n\n    if (params.indexOf(':') !== -1) {\n      params = params.split(':').map(replaceFormula).join(':')\n    } else {\n      params = params.split(',').map(replaceFormula).join(',')\n    }\n    return `=${fx.key}(${params})`\n  })\n}\n\nconst formulaParamToArray = (param: string, renderCell: (rindex: number, cindex: number) => any) => {\n  let paramValues = []\n  try {\n    if (param.indexOf(':') !== -1) {\n      const [min, max] = param.split(':');\n      const idx = /\\d+/.exec(min);\n      const maxIdx = /\\d+/.exec(max);\n      if (idx && maxIdx) {\n        // idx = idx.index;\n        // maxIdx = maxIdx.index;\n        let minC = min.substring(0, idx.index).trim()\n        let minR = parseInt(min.substring(idx.index).trim())\n\n        let maxC = max.substring(0, maxIdx.index).trim()\n        let maxR = parseInt(max.substring(maxIdx.index).trim())\n        // console.log(min, max, minR, maxR, minC, maxC)\n        if (maxC === minC) {\n          for (let i = minR; i <= maxR; i++) {\n            // console.log('value:::', i-1, alphabetIndex(minC), renderCell(i - 1, alphabetIndex(minC)))\n            paramValues.push(renderCell(i - 1, alphabetIndex(minC)))\n          }\n        } else {\n          for (let i = alphabetIndex(minC); i <= alphabetIndex(maxC); i++) {\n            paramValues.push(renderCell(minR - 1, i))\n          }\n        }\n      }\n    } else {\n      paramValues = param.split(',').map(p => {\n        // console.log(/^[0-9\\-\\+\\*\\/() ]+$/.test(p), p)\n        if (/^[0-9\\-\\+\\*\\/()\\s]+$/.test(p.trim())) {\n          try {\n            return eval(p)\n          } catch (e) {\n            return 0\n          }\n        }\n        const idx = /\\d+/.exec(p)\n        if (idx) {\n          const c = p.substring(0, idx.index).trim()\n          const r = p.substring(idx.index).trim()\n          return renderCell(parseInt(r) - 1, alphabetIndex(c))\n        }\n        return 0\n      })\n    }\n  } catch (e) {\n    console.log('warning:', e)\n  }\n  return paramValues;\n}\n\nexport const formulas: Array<Formula> = [\n  {key: 'SUM', title: 'æ±å', render: (vv) => vv.reduce((a, b) => Number(a) + Number(b), 0)},\n  {key: 'AVERAGE', title: 'å¹³åå¼', render: (vv) => vv.reduce((a, b) => Number(a) + Number(b), 0) / vv.length},\n  {key: 'MAX', title: 'æå¤§å¼', render: (vv) => Math.max(...vv.map(v => Number(v)))},\n  {key: 'MIN', title: 'æå°å¼', render: (vv) => Math.min(...vv.map(v => Number(v)))}\n]","const _alphabet = ['A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z']\nexport function alphabet(index: number): string {\n  const [a, b] = [parseInt(index / _alphabet.length + ''), index % _alphabet.length]\n  // console.log('a: ', a, '; b: ', b)\n  return a > 0 ? `${_alphabet[a - 1]}${_alphabet[b]}` : _alphabet[b]\n}\n\nexport function alphabetIndex (key: string): number {\n  let ret = 0;\n  for (let i = 0; i < key.length; i++) {\n    // console.log(key.charCodeAt(i), key[i])\n    let cindex = key.charCodeAt(i) - 65;\n    ret += i * _alphabet.length + cindex;\n  }\n  return ret;\n}\n","import { LocalSpreadsheet, Options } from './local/index';\n\nexport default function xspreadsheet (el: HTMLElement, options?: Options) {\n  return new LocalSpreadsheet(el, options)\n}\n\ndeclare global {\n  interface Window {\n    xspreadsheet: any;\n  }\n}\n\nwindow.xspreadsheet = xspreadsheet\n","import { Spreadsheet, SpreadsheetOptions, SpreadsheetData } from '../core/index'\nimport '../style/index.less'\nimport { Cell, getStyleFromCell } from '../core/cell';\nimport { Format } from '../core/format';\nimport { Font } from '../core/font';\nimport { Editor } from './editor';\nimport { Selector } from './selector';\nimport { Table } from './table';\nimport { Toolbar } from './toolbar';\nimport { Editorbar } from './editorbar';\nimport { h, Element } from './base/element'\n\nexport interface Options extends SpreadsheetOptions {\n  height?: () => number;\n  mode?: 'design' | 'write' | 'read';\n}\n\nexport class LocalSpreadsheet {\n  ss: Spreadsheet;\n  refs: {[key: string]: HTMLElement} = {};\n  table: Table;\n  toolbar: Toolbar | null = null;\n  editorbar: Editorbar | null = null;\n\n  bindEl: HTMLElement\n  options: Options;\n\n  _change: (data: SpreadsheetData) => void = () => {}\n\n  constructor (el: HTMLElement, options: Options = {}) {\n    this.bindEl = el\n    this.options = Object.assign({mode: 'design'}, options)\n\n    // clear content in el\n    this.bindEl && (this.bindEl.innerHTML = '')\n\n    this.ss = new Spreadsheet(options);\n    // console.log('::::>>>select:', this.ss.select)\n    if (this.options.mode === 'design') {\n      this.editorbar = new Editorbar()\n      this.editorbar.change = (v) => this.editorbarChange(v)\n\n      this.toolbar = new Toolbar(this.ss);\n      this.toolbar.change = (key, v) => this.toolbarChange(key, v)\n      this.toolbar.undo = () => {\n        // console.log('undo::')\n        return this.table.undo()\n      }\n      this.toolbar.redo = () => {\n        // console.log('redo::')\n        return this.table.redo()\n      }\n    }\n\n    let bodyHeightFn = (): number => {\n      if (this.options.height) {\n        return this.options.height()\n      }\n      return document.documentElement.clientHeight - 24 - 41 - 26\n    }\n    let bodyWidthFn = (): number => {\n      return this.bindEl.offsetWidth\n    }\n    this.table = new Table(this.ss, Object.assign({height: bodyHeightFn, width: bodyWidthFn, mode: this.options.mode}));\n    this.table.change = (data) => {\n      this.toolbar && this.toolbar.setRedoAble(this.ss.isRedo())\n      this.toolbar && this.toolbar.setUndoAble(this.ss.isUndo())\n      this._change(data)\n    }\n    this.table.editorChange = (v) => this.editorChange(v)\n    this.table.clickCell = (rindex, cindex, cell) => this.clickCell(rindex, cindex, cell)\n    this.render();\n  }\n\n  loadData (data: SpreadsheetData): LocalSpreadsheet {\n    // reload until waiting main thread\n    setTimeout(() => {\n      this.ss.data = data\n      this.table.reload()\n    }, 1)\n    return this\n  }\n\n  change (cb: (data: SpreadsheetData) => void): LocalSpreadsheet {\n    this._change = cb\n    return this;\n  }\n\n  private render (): void {\n    this.bindEl.appendChild(h().class('spreadsheet').children([\n      h().class('spreadsheet-bars').children([\n        this.toolbar && this.toolbar.el || '',\n        this.editorbar && this.editorbar.el || '',\n      ]),\n      this.table.el\n    ]).el);\n  }\n\n  private toolbarChange (k: keyof Cell, v: any) {\n    if (k === 'merge') {\n      this.table.merge();\n      return;\n    } else if (k === 'clearformat') {\n      this.table.clearformat();\n      return ;\n    } else if (k === 'paintformat') {\n      this.table.copyformat();\n      return ;\n    }\n\n    this.table.setCellAttr(k, v);\n  }\n\n  private editorbarChange (v: Cell) {\n    this.table.setValueWithText(v)\n  }\n\n  private editorChange (v: Cell) {\n    this.editorbar && this.editorbar.setValue(v)\n  }\n\n  private clickCell (rindex: number, cindex: number, v: Cell | null) {\n    const cols = this.ss.cols()\n    this.editorbar && this.editorbar.set(`${cols[cindex].title}${rindex + 1}`, v)\n    this.toolbar && this.toolbar.set(this.table.td(rindex, cindex), v)\n  }\n\n}\n","import { Format, formats } from './format'\nimport { Font, fonts } from './font'\nimport { Formula, formulas, formulaReplaceParam } from './formula'\nimport { Cell, defaultCell } from './cell'\nimport { alphabet } from './alphabet'\nimport { Select } from './select'\nimport { unbind } from '../local/event';\n\nexport interface Row {\n  height: number\n}\nexport interface Col {\n  title: string\n  width: number\n}\nexport interface MapInt<T> {\n  [key: number]: T\n}\nexport class History {\n  values: Array<[Array<any>, any, any]> = [];\n  constructor (public type: 'rows' | 'cols' | 'cells') {}\n  add (keys: Array<any>, oldValue: any, value: any) {\n    this.values.push([keys, oldValue, value])\n  }\n}\n// types\nexport type StandardCallback = (rindex: number, cindex: number, cell: Cell) => void;\n\nexport interface SpreadsheetData {\n  rowHeight?: number;\n  colWidth?: number;\n  rows?: MapInt<Row>;\n  cols?: MapInt<Col>;\n  cell: Cell; // global default cell\n  cells?: MapInt<MapInt<Cell>>;\n  [prop: string]: any\n}\n\nexport interface SpreadsheetOptions {\n  formats?: Array<Format>;\n  fonts?: Array<Font>;\n  formulas?: Array<Formula>;\n  data?: SpreadsheetData;\n}\n\nexport class Spreadsheet {\n  formats: Array<Format>;\n  fonts: Array<Font>;\n  formulas: Array<Formula>;\n  data: SpreadsheetData;\n  private histories: Array<History> = [];\n  private histories2: Array<History> = [];\n  private currentCellIndexes: [number, number] = [0, 0];\n  select: Select | null = null;\n  private copySelect: Select | null = null;\n  private cutSelect: Select | null = null;\n\n  change: (data: SpreadsheetData) => void = () => {}\n\n  constructor (options: SpreadsheetOptions = {}) {\n    this.formats = options.formats || formats\n    this.fonts = options.fonts || fonts\n    this.formulas = options.formulas || formulas\n    // init data\n    this.data = {rowHeight: 22, colWidth: 100, cell: defaultCell}\n    if (options.data) {\n      const { data } = options;\n      for (let prop of ['rowHeight', 'colWidth', 'rows', 'cols', 'cells']) {\n        if (data[prop]) {\n          this.data[prop] = data[prop];\n        }\n      }\n      (<any>Object).assign(this.data.cell, data.cell || {});\n    }\n  }\n\n  // build select\n  buildSelect (startTarget: any, endTarget: any) {\n    const startAttrs = getElementAttrs(startTarget)\n    const endAttrs = getElementAttrs(endTarget)\n    // console.log(':::::::>>>', startAttrs, endAttrs)\n    let sRow = startAttrs.row\n    let sCol = startAttrs.col\n    let eRow = endAttrs.row\n    let eCol = endAttrs.col\n    if (sRow > eRow) {\n      sRow = endAttrs.row\n      eRow = startAttrs.row\n    }\n    if (sCol > eCol) {\n      sCol = endAttrs.col\n      eCol = startAttrs.col\n    }\n    // calc min, max of row\n    // console.log('s: ', sRow, sCol, ', e: ', eRow, eCol)\n    let [minRow, maxRow] = calcMinï¼­axRow((r: number, c: number) => this.getCell(r, c), sRow, eRow, sCol, eCol)\n    // console.log('minRow: ', minRow, ', maxRow: ', maxRow)\n    // calc min, max of col\n    let [minCol, maxCol] = calcMinMaxCol((r: number, c: number) => this.getCell(r, c), minRow, maxRow, sCol, eCol)\n    while (true) {\n      const [minr, maxr] = calcMinï¼­axRow((r: number, c: number) => this.getCell(r, c), minRow, maxRow, minCol, maxCol)\n      let [minc, maxc] = calcMinMaxCol((r: number, c: number) => this.getCell(r, c), minRow, maxRow, minCol, maxCol)\n      if (minRow === minr && maxRow === maxr && minCol === minc && maxCol === maxc) {\n        break\n      }\n      minRow = minr\n      maxRow = maxr\n      minCol = minc\n      maxCol = maxc\n    }\n    const firstCell = this.getCell(minRow, minCol)\n    // console.log('first => rowspan: ', firstCell.rowspan, ', colspan: ', firstCell.colspan)\n    let canotMerge = minRow + (firstCell && firstCell.rowspan || 1) - 1 === maxRow && minCol + (firstCell && firstCell.colspan || 1) - 1 === maxCol\n    // console.log('row: ', minRow, maxRow, ', col:', minCol, maxCol, canotMerge)\n    // è®¡ç®æ¯å¦å¯ä»¥merge\n    this.select = new Select([minRow, minCol], [maxRow, maxCol], !canotMerge)\n    return this.select\n  }\n\n  defaultRowHeight (): number {\n    return this.data.rowHeight || 22\n  }\n\n  defaultColWidth (): number {\n    return this.data.colWidth || 100\n  }\n\n  copy (): void {\n    this.copySelect = this.select\n  }\n  cut (): void {\n    this.cutSelect = this.select\n  }\n  paste (cb: StandardCallback, state: 'copy' | 'cut' | 'copyformat', clear: StandardCallback): void {\n    let cselect = this.copySelect\n    if (this.cutSelect) {\n      cselect = this.cutSelect\n      this.cutSelect = null\n    }\n    if (cselect && this.select) {\n      const history = new History('cells')\n      if (state === 'copyformat') {\n        this.select.forEach((rindex, cindex, i, j, rowspan, colspan) => {\n          if (cselect) {\n            const srcRowIndex = cselect.rowIndex(i)\n            const srcColIndex = cselect.colIndex(j)\n            const [oldCell, newCell] = this.copyCell(srcRowIndex, srcColIndex, rindex, cindex, state, cb, clear)\n            history.add([rindex, cindex], oldCell, newCell)\n          }\n        })\n      } else {\n        cselect.forEach((rindex, cindex, i, j, rowspan, colspan) => {\n          if (this.select) {\n            const destRowIndex = this.select.start[0] + i\n            const destColIndex = this.select.start[1] + j\n            const [oldCell, newCell] = this.copyCell(rindex, cindex, destRowIndex, destColIndex, state, cb, clear)\n            history.add([destRowIndex, destColIndex], oldCell, newCell)\n          }\n        })\n      }\n      this.histories.push(history)\n      this.change(this.data)\n    }\n  }\n  insert (type: 'row' | 'col', amount: number, cb: StandardCallback) {\n    if (this.select) {\n      const { cells } = this.data\n      const [srindex, scindex] = this.select.start\n      if (!cells) return\n\n      // console.log('insert.before.data:', cells)\n      const history = new History('cells')\n      if (type === 'row') {\n        const newCells: MapInt<MapInt<Cell>> = {}\n        Object.keys(cells).forEach(key => {\n          let rindex = parseInt(key)\n          let values = cells[rindex]\n          if (srindex <= rindex) {\n            Object.keys(values).forEach(key1 => {\n              let cindex = parseInt(key1)\n              // clear current cell\n              cb(rindex, cindex, {})\n              history.add([rindex, cindex], values[cindex], undefined)\n            \n              // set next cell is current celll\n              cb(rindex + 1, cindex, values[cindex] || {})\n              history.add([rindex + 1, cindex], this.getCell(rindex + 1, cindex), values[cindex])\n            })\n          }\n          newCells[srindex <= rindex ? rindex + 1 : rindex] = cells[rindex]\n        })\n        this.data.cells = newCells\n      } else if (type === 'col') {\n        Object.keys(cells).forEach(key => {\n          let rindex = parseInt(key)\n          let values = cells[rindex]\n          let newCell: MapInt<Cell> = {}\n          Object.keys(values).forEach(key1 => {\n            let cindex = parseInt(key1)\n            if (scindex <= cindex) {\n              // clear å½åcell\n              cb(rindex, cindex, {})\n              history.add([rindex, cindex], values[cindex], undefined)\n            \n              // è®¾ç½®ä¸ä¸ä¸ªcell ç­äºå½åçcell\n              cb(rindex, cindex + 1, values[cindex] || {})\n              history.add([rindex, cindex + 1], this.getCell(rindex, cindex + 1), values[cindex])\n            }\n            newCell[scindex <= cindex ? cindex + 1 : cindex] = values[cindex]\n          })\n          cells[rindex] = newCell\n        })\n      }\n      this.histories.push(history)\n      // console.log('insert.after.data:', this.data.cells)\n    } \n  }\n\n  batchPaste (arrow: 'bottom' | 'top' | 'left' | 'right',\n    startRow: number, startCol: number, stopRow: number, stopCol: number,\n    seqCopy: boolean,\n    cb: StandardCallback) {\n    if (this.select) {\n      const history = new History('cells')\n      for (let i = startRow; i <= stopRow; i++) {\n        for (let j = startCol; j <= stopCol; j++) {\n          const srcRowIndex = this.select.rowIndex(i - startRow)\n          const srcColIndex = this.select.colIndex(j - startCol)\n          const [oldDestCell, destCell] = this.copyCell(srcRowIndex, srcColIndex, i, j, seqCopy ? 'seqCopy' : 'copy', cb, () => {})\n          history.add([i, j], oldDestCell, destCell)\n        }\n      }\n      this.histories.push(history)\n      this.change(this.data)\n    }\n  }\n  private copyCell (srcRowIndex: number, srcColIndex: number, destRowIndex: number, destColIndex: number,\n    state: 'seqCopy' | 'copy' | 'cut' | 'copyformat', cb: StandardCallback, clear: StandardCallback): [Cell | null, Cell | null] {\n    const srcCell = this.getCell(srcRowIndex, srcColIndex)\n    const rowDiff = destRowIndex - srcRowIndex\n    const colDiff = destColIndex - srcColIndex\n    if (srcCell) {\n      let oldDestCell = this.getCell(destRowIndex, destColIndex)\n      // let destCell = cellCopy(srcCell, destRowIndex - srcRowIndex, destColIndex - srcColIndex, state === 'seqCopy')\n      const destCell = Object.assign({}, srcCell)\n      if (srcCell.merge) {\n        const [m1, m2] = srcCell.merge\n        destCell.merge = [m1 + rowDiff, m2 + colDiff];\n      }\n      \n\n      if (state === 'cut') {\n        clear(srcRowIndex, srcColIndex, this.cell(srcRowIndex, srcColIndex, {}))\n      }\n      if (state === 'copyformat') {\n        if (oldDestCell && oldDestCell.text) {\n          destCell.text = oldDestCell.text\n        }\n      } else {\n        const txt = destCell.text\n        if (txt && !/^\\s*$/.test(txt)) {\n          if (/^\\d*$/.test(txt) && state === 'seqCopy') {\n            destCell.text = (parseInt(txt) + (destRowIndex - srcRowIndex) + (destColIndex - srcColIndex)) + ''\n          } else if (txt.indexOf('=') !== -1) {\n            // å¦ætextçåå®¹æ¯formula,é£ä¹éè¦éè¦ä¿®æ¹è¡¨è¾¾å¼åæ°\n            destCell.text = formulaReplaceParam(txt, rowDiff, colDiff)\n          }\n        }\n      }\n\n      cb(destRowIndex, destColIndex, this.cell(destRowIndex, destColIndex, destCell))\n      return [oldDestCell, destCell];\n    }\n    return [null, null];\n  }\n\n  isRedo (): boolean {\n    return this.histories2.length > 0\n  }\n  redo (cb: StandardCallback): boolean {\n    const { histories, histories2 } = this\n    if (histories2.length > 0) {\n      const history = histories2.pop()\n      if (history) {\n        this.resetByHistory(history, cb, 'redo')\n        histories.push(history)\n        this.change(this.data)\n      }\n    }\n    return this.isRedo()\n  }\n\n  isUndo (): boolean {\n    return this.histories.length > 0\n  }\n  undo (cb: StandardCallback): boolean {\n    const { histories, histories2 } = this\n    // console.log('histories:', histories, histories2)\n    if (histories.length > 0) {\n      const history = histories.pop()\n      if (history) {\n        this.resetByHistory(history, cb, 'undo')\n        histories2.push(history)\n        this.change(this.data)\n      }\n    }\n    return this.isUndo()\n  }\n\n  resetByHistory (v: History, cb: StandardCallback, state: 'undo' | 'redo') {\n    // console.log('history: ', history)\n    v.values.forEach(([keys, oldValue, value]) => {\n      if (v.type === 'cells') {\n        const v = state === 'undo' ? oldValue : value\n        const oldCell = this.getCell(keys[0], keys[1])\n        if (!oldCell) {\n          if (keys.length === 3) {\n            if (v) {\n              const nValue: Cell = {}\n              nValue[keys[2]] = v\n              cb(keys[0], keys[1], this.cell(keys[0], keys[1], nValue))\n            }\n          } else {\n            cb(keys[0], keys[1], this.cell(keys[0], keys[1], v || {}))\n          }\n        } else {\n          if (keys.length === 3) {\n            const nValue: Cell = {}\n            nValue[keys[2]] = v\n            if (v) {\n              cb(keys[0], keys[1], this.cell(keys[0], keys[1], nValue, true))\n            } else {\n              cb(keys[0], keys[1], this.cell(keys[0], keys[1], mapIntFilter(oldCell, keys[2])))\n            }\n          } else {\n            cb(keys[0], keys[1], this.cell(keys[0], keys[1], v || {}))\n          }\n        }\n      } else {\n        // cols, rows\n        // const v = state === 'undo' ? oldValue : value\n        // if (v !== null) {\n        //   this.data[v.type]\n        // }\n      }\n      // console.log('keys:', keys, ', oldValue:', oldValue, ', value:', value)\n    })\n  }\n\n  clearformat (cb: StandardCallback) {\n    const { select } = this\n    if (select !== null) {\n      const history = new History('cells')\n      select.forEach((rindex, cindex, i, j, rowspan, colspan) => {\n        let c = this.getCell(rindex, cindex);\n        if (c) {\n          history.add([rindex, cindex], c, {text: c.text})\n          c = this.cell(rindex, cindex, {text: c.text});\n          cb(rindex, cindex, c);\n        }\n      });\n      this.histories.push(history)\n      this.change(this.data)\n    }\n  }\n\n  /**\n   * \n   * @param ok åå¹¶ååæ ¼ç¬¬ä¸ä¸ªååæ ¼ï¼å·¦ä¸è§ï¼çåè°å½æ°\n   * @param cancel åæ¶åå¹¶ååæ ¼ç¬¬ä¸ä¸ªååæ ¼ï¼å·¦ä¸è§ï¼çåè°å½æ°\n   * @param other å¶ä»ååæ ¼çåè°å½æ°\n   */\n  merge (ok: StandardCallback, cancel: StandardCallback, other: StandardCallback): void {\n    const { select } = this\n    // console.log('data.before: ', this.data)\n    if (select !== null && select.cellLen() > 1) {\n      // merge merge: [rows[0], cols[0]]\n      const history = new History('cells')\n      let index = 0\n      let firstXY: [number, number] = [0, 0]\n      select.forEach((rindex, cindex, i, j, rowspan, colspan) => {\n        if (index++ === 0) {\n          firstXY = [rindex, cindex]\n          let v: Cell = {}\n          if (rowspan > 1) v.rowspan = rowspan\n          if (colspan > 1) v.colspan = colspan\n          // console.log('rowspan:', rowspan, ', colspan:', colspan, select.canMerge)\n          if (select.canMerge) {\n            history.add([rindex, cindex, 'rowspan'], undefined, rowspan)\n            history.add([rindex, cindex, 'colspan'], undefined, colspan)\n\n            let cell = this.cell(rindex, cindex, v, true)\n            ok(rindex, cindex, cell)\n          } else {\n            const oldCell = this.getCell(rindex, cindex)\n            if (oldCell !== null) {\n              history.add([rindex, cindex, 'rowspan'], oldCell.rowspan, undefined)\n              history.add([rindex, cindex, 'colspan'], oldCell.colspan, undefined)\n\n              let cell = this.cell(rindex, cindex, mapIntFilter(oldCell, 'rowspan', 'colspan', 'merge'))\n              cancel(rindex, cindex, cell)\n            }\n          }\n        } else {\n          let v: Cell = {invisible: select.canMerge}\n          if (select.canMerge) {\n            history.add([rindex, cindex, 'invisible'], undefined, select.canMerge)\n\n            v.merge = firstXY\n            let cell = this.cell(rindex, cindex, v, true)\n            other(rindex, cindex, cell)\n          } else {\n            const oldCell = this.getCell(rindex, cindex)\n            if (oldCell !== null) {\n              history.add([rindex, cindex, 'invisible'], oldCell.invisible, undefined)\n              let cell = this.cell(rindex, cindex, mapIntFilter(oldCell, 'rowspan', 'colspan', 'merge', 'invisible'))\n              other(rindex, cindex, cell)\n            }\n          }\n        }\n      })\n      this.histories.push(history)\n      select.canMerge = !select.canMerge\n      this.change(this.data)\n    }\n  }\n  cellAttr (key: keyof Cell, value: any, cb: StandardCallback): void {\n    let v: Cell= {}\n    v[key] = value\n    const isDefault = value === this.data.cell[key]\n    if (this.select !== null) {\n      const history = new History('cells')\n      this.select.forEach((rindex, cindex) => {\n        const oldCell = this.getCell(rindex, cindex)\n        \n        history.add([rindex, cindex, key], oldCell !== null ? oldCell[key] : undefined, value)\n        \n        let cell = this.cell(rindex, cindex, isDefault ? mapIntFilter(oldCell, key) : v, !isDefault)\n        cb(rindex, cindex, cell)\n      \n      })\n      this.histories.push(history)\n    }\n    this.change(this.data)\n  }\n  cellText (value: any, cb: StandardCallback): Cell | null {\n    if (this.currentCellIndexes) {\n      // this.addHistoryValues()\n      const history = new History('cells')\n      const [rindex, cindex] = this.currentCellIndexes\n      const oldCell = this.getCell(rindex, cindex)\n      history.add([rindex, cindex, 'text'], oldCell !== null ? oldCell.text : undefined, value)\n      const cell = this.cell(rindex, cindex, {text: value}, true)\n      cb(rindex, cindex, cell)\n\n      this.histories.push(history)\n      this.change(this.data)\n      return cell;\n    }\n    return null\n  }\n  currentCell (indexes?: [number, number]): Cell | null {\n    if (indexes !== undefined) {\n      this.currentCellIndexes = indexes\n    }\n    const [rindex, cindex] = this.currentCellIndexes\n    return this.getCell(rindex, cindex)\n  }\n\n  cell (rindex: number, cindex: number, v: any, isCopy = false): Cell {\n    this.data.cells = this.data.cells || {}\n    this.data.cells[rindex] = this.data.cells[rindex] || {}\n    this.data.cells[rindex][cindex] = this.data.cells[rindex][cindex] || {}\n    if (isCopy) {\n      (<any>Object).assign(this.data.cells[rindex][cindex], v)\n    } else if (v) {\n      this.data.cells[rindex][cindex] = v\n    }\n    return this.data.cells[rindex][cindex]\n  }\n\n  getCell (rindex: number, cindex: number): Cell | null {\n    if (this.data.cells && this.data.cells[rindex] && this.data.cells[rindex][cindex]) {\n      return this.data.cells[rindex][cindex];\n    }\n    return null;\n  }\n\n  getFont (key: string | undefined) {\n    return this.fonts.filter(it => it.key === key)[0]\n  }\n  getFormat (key: string | undefined) {\n    return this.formats.filter(it => it.key === key)[0]\n  }\n\n  row (index: number, v?: number): Row {\n    const { data } = this;\n    if (v !== undefined) {\n      const history = new History('rows')\n      data.rows = data.rows || {}\n      data.rows[index] = data.rows[index] || {}\n      data.rows[index].height = v\n      history.add([index], null, data.rows[index])\n      this.histories.push(history)\n    }\n    return (<any>Object).assign({height: data.rowHeight}, data.rows ? data.rows[index] : {})\n  }\n  // isData æ¯å¦è¿åæ°æ®çæå¤§è¡æ°\n  rows (isData: boolean): Array<Row> {\n    const { data } = this;\n    let maxRow;\n    if (isData) {\n      maxRow = 10\n      if (this.data.cells) {\n        maxRow = mapIntMaxKey(this.data.cells) + 2\n      }\n    } else {\n      maxRow = mapIntMaxKeyWithDefault(100, data.rows)\n    }\n    return range(maxRow, (index) => this.row(index))\n  }\n\n  col (index: number, v?: number): Col {\n    const { data } = this;\n    if (v !== undefined) {\n      const history = new History('cols')\n      data.cols = data.cols || {}\n      data.cols[index] = data.cols[index] || {}\n      data.cols[index].width = v\n      history.add([index], null, data.cols[index])\n      this.histories.push(history)\n    }\n    const ret:any = {width: data.colWidth, title: alphabet(index)}\n    if (data.cols && data.cols[index]) {\n      for (let prop in data.cols[index]) {\n        const col:any = data.cols[index]\n        if (col[prop]) {\n          ret[prop] = col[prop]\n        }\n      }\n    }\n    return ret\n  }\n  cols (): Array<Col> {\n    const { data } = this;\n    let maxCol = mapIntMaxKeyWithDefault(26 * 2, data.cols);\n    return range(maxCol, (index) => this.col(index));\n  }\n}\n\nconst mapIntMaxKey = function<T>(mapInt: MapInt<T>): number {\n  return Math.max(...Object.keys(mapInt).map(s => parseInt(s)))\n}\n// methods\nconst mapIntMaxKeyWithDefault = function<T>(max: number, mapInt: MapInt<T> | undefined): number {\n  if (mapInt) {\n    const m = mapIntMaxKey(mapInt)\n    if (m > max) return m;\n  }\n  return max;\n}\nconst mapIntFilter = function(obj: any, ...keys: Array<any>): any {\n  const ret: any = {}\n  if (obj){\n    Object.keys(obj).forEach(e => {\n      if (keys.indexOf(e) === -1) {\n        ret[e] = obj[e]\n      }\n    })\n  }\n  return ret\n}\nconst range = function<T>(stop:number, cb: (index: number) => T): Array<T> {\n  const ret = []\n  for (let i = 0; i < stop; i++) {\n    ret.push(cb(i))\n  }\n  return ret\n}\nconst getElementAttrs = (target: any) => {\n  const { offsetTop, offsetLeft, offsetHeight, offsetWidth } = target\n  return {\n    row: parseInt(target.getAttribute('row-index')),\n    col: parseInt(target.getAttribute('col-index')),\n    rowspan: parseInt(target.getAttribute('rowspan')),\n    colspan: parseInt(target.getAttribute('colspan')),\n    left: offsetLeft,\n    top: offsetTop,\n    width: offsetWidth,\n    height: offsetHeight\n  }\n}\nconst calcMinMaxCol = (cell: any, sRow: number, eRow: number, sCol: number, eCol: number) => {\n  let minCol = sCol\n  let maxCol = eCol\n  // console.log(':::::::;start: ', maxCol, minCol)\n  for (let j = sRow; j <= eRow; j++) {\n    let cCol = sCol\n    let dcell = cell(j, cCol)\n    if (dcell && dcell.merge) {\n      cCol += dcell.merge[1] - cCol\n    }\n    if (cCol < minCol) minCol = cCol\n\n    cCol = maxCol\n    dcell = cell(j, cCol)\n    // console.log(j, cCol, dcell && dcell.colspan || 1)\n    const cColspan = dcell ? dcell.colspan : 1\n    if (parseInt(cColspan) > 1) {\n      cCol += parseInt(cColspan)\n    } else {\n      if (dcell && dcell.merge) {\n        // console.log('merge::', maxCol, dcell.merge)\n        const [r, c] = dcell.merge\n        const rc = cell(r, c).colspan\n        cCol += rc + (c - cCol)\n      }\n    }\n    // console.log('cCol: ', cCol, ', maxCol: ', maxCol)\n    // console.log(':::::::;end: ', maxCol, minCol)\n    if (cCol - 1 > maxCol) maxCol = cCol - 1\n  }\n  return [minCol, maxCol]\n}\nconst calcMinï¼­axRow = (cell: any, sRow: number, eRow: number, sCol: number, eCol: number) => {\n  let minRow = sRow\n  let maxRow = eRow\n  for (let j = sCol; j <= eCol; j++) {\n    let cRow = sRow\n    let dcell = cell(cRow, j)\n    if (dcell && dcell.merge) {\n      cRow += dcell.merge[0] - cRow\n    }\n    if (cRow < minRow) minRow = cRow\n\n    cRow = maxRow\n    dcell = cell(cRow, j)\n    // console.log('row: ', j, cRow, dcell.rowspan)\n    const cRowspan = dcell ? dcell.rowspan : 1\n    if (parseInt(cRowspan) > 1) {\n      cRow += parseInt(cRowspan)\n    } else {\n      if (dcell && dcell.merge) {\n        const [r, c] = dcell.merge\n        const rs = cell(r, c).rowspan\n        cRow += rs + (r - cRow)\n      }\n    }\n    if (cRow - 1 > maxRow) maxRow = cRow - 1\n  }\n  return [minRow, maxRow]\n}","export interface Font {\n  key: string;\n  title: string;\n}\n\nexport const fonts: Array<Font> = [\n  {key: 'Microsoft YaHei', title: 'å¾®è½¯éé»'},\n  {key: 'STFangsong', title: 'åæä»¿å®'},\n  {key: 'Comic Sans MS', title: 'Comic Sans MS'},\n  {key: 'Arial', title: 'Arial'},\n  {key: 'Courier New', title: 'Courier New'},\n  {key: 'Verdana', title: 'Verdana'}\n]","export class Select {\n  constructor(public start: [number, number], public stop: [number, number], public canMerge: boolean) {}\n  forEach (cb: (r:number, c: number, rindex: number, cindex: number, rowspan: number, colspan: number) => void): void {\n    const [sx, sy] = this.start\n    const [ex, ey] = this.stop\n    for (let i = sx; i <= ex; i++) {\n      for (let j = sy; j <= ey; j++) {\n        cb(i, j, i - sx, j - sy, ex - sx + 1, ey - sy + 1)\n      }\n    }\n  }\n  rowIndex (index: number) {\n    return this.start[0] + index % this.rowLen()\n  }\n  colIndex (index: number) {\n    return this.start[1] + index % this.colLen()\n  }\n  rowLen () {\n    return this.stop[0] - this.start[0] + 1\n  }\n  colLen () {\n    return this.stop[1] - this.start[1] + 1\n  }\n  cellLen () {\n    return this.rowLen() * this.colLen()\n  }\n  contains (rindex: number, cindex: number) {\n    const [sx, sy] = this.start\n    const [ex, ey] = this.stop\n    return sx <= rindex && ex >= rindex && sy <= cindex && ey >= cindex\n  }\n}\n\n// export function buildSelect (start: any, end: )","\nvar content = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/dist/cjs.js!./index.less\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/dist/cjs.js!./index.less\", function() {\n\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/dist/cjs.js!./index.less\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","var escape = require(\"../../node_modules/css-loader/lib/url/escape.js\");\nexports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"body {\\n  margin: 0;\\n}\\n.spreadsheet {\\n  font-size: 14px;\\n  line-height: normal;\\n  user-select: none;\\n  -moz-user-select: none;\\n  font-family: Roboto, Helvetica, Arial, sans-serif;\\n  box-sizing: content-box;\\n  background: #fff;\\n}\\n.spreadsheet .spreadsheet-table {\\n  position: relative;\\n  background: #fff;\\n}\\n.spreadsheet .spreadsheet-fixed {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  z-index: 10;\\n  background: #fff;\\n}\\n.spreadsheet .spreadsheet-fixed .spreadsheet-fixed-body {\\n  overflow: hidden;\\n}\\n.spreadsheet .spreadsheet-fixed .spreadsheet-fixed-header {\\n  overflow: hidden;\\n}\\n.spreadsheet .spreadsheet-body {\\n  overflow: scroll;\\n  position: relative;\\n}\\n.spreadsheet .spreadsheet-header {\\n  overflow: hidden;\\n  width: 100%;\\n}\\n.spreadsheet .spreadsheet-header table,\\n.spreadsheet .spreadsheet-body table,\\n.spreadsheet .spreadsheet-fixed table {\\n  table-layout: fixed;\\n  text-align: left;\\n  width: 100%;\\n  border-collapse: separate;\\n  border-spacing: 0;\\n  color: #000;\\n}\\n.spreadsheet .spreadsheet-header table td,\\n.spreadsheet .spreadsheet-body table td,\\n.spreadsheet .spreadsheet-fixed table td,\\n.spreadsheet .spreadsheet-header table th,\\n.spreadsheet .spreadsheet-body table th,\\n.spreadsheet .spreadsheet-fixed table th {\\n  transition: background 0.1s ease, color 0.1s ease;\\n  border-bottom: 1px solid #e0e2e4;\\n  border-right: 1px solid #e0e2e4;\\n  white-space: nowrap;\\n  text-overflow: ellipsis;\\n  overflow: hidden;\\n  padding: 0 4px;\\n  line-height: 22px;\\n}\\n.spreadsheet .spreadsheet-header table td.active,\\n.spreadsheet .spreadsheet-body table td.active,\\n.spreadsheet .spreadsheet-fixed table td.active,\\n.spreadsheet .spreadsheet-header table th.active,\\n.spreadsheet .spreadsheet-body table th.active,\\n.spreadsheet .spreadsheet-fixed table th.active {\\n  background: rgba(75, 137, 255, 0.05) !important;\\n}\\n.spreadsheet .spreadsheet-header table th,\\n.spreadsheet .spreadsheet-body table th,\\n.spreadsheet .spreadsheet-fixed table th {\\n  border-top: 1px solid #e0e2e4;\\n  text-align: center;\\n}\\n.spreadsheet .spreadsheet-header table th,\\n.spreadsheet .spreadsheet-body table th,\\n.spreadsheet .spreadsheet-fixed table th,\\n.spreadsheet .spreadsheet-header table td:first-child,\\n.spreadsheet .spreadsheet-body table td:first-child,\\n.spreadsheet .spreadsheet-fixed table td:first-child {\\n  font-size: 12px;\\n  background: #f4f5f8;\\n  font-weight: normal;\\n  color: #666;\\n}\\n.spreadsheet .spreadsheet-header table td:first-child,\\n.spreadsheet .spreadsheet-body table td:first-child,\\n.spreadsheet .spreadsheet-fixed table td:first-child,\\n.spreadsheet .spreadsheet-header table th:first-child,\\n.spreadsheet .spreadsheet-body table th:first-child,\\n.spreadsheet .spreadsheet-fixed table th:first-child {\\n  border-left: 1px solid #e0e2e4;\\n  text-align: center;\\n}\\n.spreadsheet-editor {\\n  position: absolute;\\n  text-align: left;\\n  border: 2px solid #4b89ff;\\n  line-height: 0;\\n  z-index: 10;\\n}\\n.spreadsheet-editor textarea {\\n  box-sizing: content-box;\\n  border: none;\\n  padding: 0 3px;\\n  outline-width: 0;\\n  resize: none;\\n  text-align: start;\\n  overflow-y: hidden;\\n  font-family: inherit;\\n  font-size: inherit;\\n  color: inherit;\\n  white-space: normal;\\n  word-wrap: break-word;\\n  line-height: 22px;\\n  margin: 0;\\n}\\n.spreadsheet-suggest,\\n.spreadsheet-contextmenu {\\n  position: absolute;\\n  box-shadow: 1px 2px 5px 2px rgba(51, 51, 51, 0.15);\\n  background: #fff;\\n  z-index: 100;\\n}\\n.spreadsheet-resizer {\\n  position: absolute;\\n  z-index: 11;\\n}\\n.spreadsheet-resizer.horizontal {\\n  cursor: row-resize;\\n}\\n.spreadsheet-resizer.vertical {\\n  cursor: col-resize;\\n}\\n.spreadsheet-resizer-line {\\n  position: absolute;\\n  z-index: 100;\\n}\\n.spreadsheet-resizer-line.horizontal {\\n  border-bottom: 2px dashed #4b89ff;\\n}\\n.spreadsheet-resizer-line.vertical {\\n  border-right: 2px dashed #4b89ff;\\n}\\n.spreadsheet-borders {\\n  box-sizing: content-box;\\n}\\n.spreadsheet-borders.dashed {\\n  border: 2px dashed #4b89ff;\\n  position: absolute;\\n  background: rgba(75, 137, 255, 0.03);\\n}\\n.spreadsheet-borders .left-border,\\n.spreadsheet-borders .right-border,\\n.spreadsheet-borders .bottom-border,\\n.spreadsheet-borders .top-border,\\n.spreadsheet-borders .area-border {\\n  position: absolute;\\n  font-size: 0;\\n  pointer-events: none;\\n  background: #4b89ff;\\n}\\n.spreadsheet-borders .area-border {\\n  background: rgba(75, 137, 255, 0.03);\\n}\\n.spreadsheet-borders .corner {\\n  cursor: crosshair;\\n  font-size: 0;\\n  height: 5px;\\n  width: 5px;\\n  border: 2px solid #ffffff;\\n  position: absolute;\\n  bottom: -6px;\\n  right: -6px;\\n  background: #4b89ff;\\n}\\n.spreadsheet-borders .copy-border {\\n  position: absolute;\\n  pointer-events: none;\\n  border: 1px dashed #4b89ff;\\n  background: rgba(75, 137, 255, 0.03);\\n}\\n.spreadsheet-paint-border {\\n  position: absolute;\\n  pointer-events: none;\\n  border: 1px dashed #4b89ff;\\n  background: rgba(75, 137, 255, 0.03);\\n}\\n.spreadsheet-bars .spreadsheet-toolbar {\\n  height: 40px;\\n  text-align: left;\\n  padding: 0 60px;\\n  border-bottom: 1px solid #e0e2e4;\\n  background: #f5f6f7;\\n}\\n.spreadsheet-bars .spreadsheet-toolbar > .spreadsheet-menu > .spreadsheet-item {\\n  margin: 7px 1px 0;\\n}\\n.spreadsheet-bars .spreadsheet-editor-bar {\\n  width: 100%;\\n  height: 26px;\\n  line-height: 26px;\\n  position: relative;\\n  background: #fff;\\n  padding: 0;\\n}\\n.spreadsheet-formula-bar {\\n  position: relative;\\n  height: 100%;\\n}\\n.spreadsheet-formula-bar .spreadsheet-formula-label {\\n  width: 60px;\\n  height: 100%;\\n  box-sizing: border-box;\\n  display: inline-block;\\n  text-align: center;\\n  border-right: 1px solid #e0e2e4;\\n  background-color: #fff;\\n  font-size: 12px;\\n  color: #777;\\n  user-select: none;\\n  float: left;\\n  vertical-align: middle;\\n}\\n.spreadsheet-formula-bar textarea {\\n  width: calc(100% - 60px);\\n  height: 100%;\\n  box-sizing: border-box;\\n  font-family: inherit;\\n  font-size: inherit;\\n  padding: 4px 10px;\\n  position: relative;\\n  float: left;\\n  resize: none;\\n  overflow-y: hidden;\\n  border: none;\\n  outline-width: 0;\\n  margin: 0;\\n  line-height: 1.2rem;\\n}\\n.spreadsheet-formula-bar-resizer {\\n  cursor: ns-resize;\\n  height: 4px;\\n  position: absolute;\\n  width: 100%;\\n  left: 0;\\n  bottom: 0;\\n}\\n.spreadsheet-menu.vertical > .spreadsheet-item-separator {\\n  background: #e0e2e4;\\n  height: 1px;\\n  margin: 5px 0;\\n}\\n.spreadsheet-menu.vertical > .spreadsheet-item {\\n  padding: 2px 10px;\\n  border-radius: 0;\\n}\\n.spreadsheet-menu.horizontal > .spreadsheet-item {\\n  display: inline-block;\\n}\\n.spreadsheet-menu.horizontal > .spreadsheet-item-separator {\\n  display: inline-block;\\n  background: #e0e2e4;\\n  width: 1px;\\n  vertical-align: middle;\\n  height: 18px;\\n  margin: 0 3px;\\n}\\n.spreadsheet-menu > .spreadsheet-item {\\n  border-radius: 2px;\\n  user-select: none;\\n  background: 0;\\n  border: 1px solid transparent;\\n  outline: none;\\n  height: 24px;\\n  color: rgba(0, 0, 0, 0.8);\\n  line-height: 24px;\\n  list-style: none;\\n  cursor: default;\\n}\\n.spreadsheet-menu > .spreadsheet-item.disabled {\\n  pointer-events: none;\\n  opacity: 0.5;\\n}\\n.spreadsheet-menu > .spreadsheet-item:not(.separator):hover,\\n.spreadsheet-menu > .spreadsheet-item.active {\\n  background: rgba(0, 0, 0, 0.08);\\n}\\n.spreadsheet-menu > .spreadsheet-item:not(.separator):hover .spreadsheet-icon-img,\\n.spreadsheet-menu > .spreadsheet-item.active .spreadsheet-icon-img {\\n  opacity: 0.7;\\n}\\n.spreadsheet-menu > .spreadsheet-item:not(.separator):hover .spreadsheet-dropdown-icon,\\n.spreadsheet-menu > .spreadsheet-item.active .spreadsheet-dropdown-icon {\\n  background-color: rgba(0, 0, 0, 0.15);\\n  opacity: 0.6;\\n}\\n.spreadsheet-menu > .spreadsheet-item > .label {\\n  float: right;\\n  opacity: 0.8;\\n}\\n.spreadsheet-dropdown {\\n  position: relative;\\n  display: inline-block;\\n  width: auto!important;\\n}\\n.spreadsheet-dropdown .spreadsheet-dropdown-content {\\n  position: absolute;\\n  top: calc(100% + 5px);\\n  left: 0;\\n  z-index: 200;\\n  background: #fff;\\n  box-shadow: 1px 2px 5px 2px rgba(51, 51, 51, 0.15);\\n  width: auto;\\n}\\n.spreadsheet-dropdown .spreadsheet-dropdown-header .spreadsheet-dropdown-title {\\n  padding: 0 5px;\\n  display: inline-block;\\n}\\n.spreadsheet-dropdown .spreadsheet-dropdown-header .spreadsheet-dropdown-icon {\\n  display: inline-block;\\n  vertical-align: top;\\n}\\n.spreadsheet-dropdown .spreadsheet-dropdown-header .spreadsheet-dropdown-icon .spreadsheet-icon {\\n  width: 10px;\\n}\\n.spreadsheet-dropdown .spreadsheet-dropdown-header .spreadsheet-dropdown-icon .spreadsheet-icon .arrow-down {\\n  left: -130px;\\n}\\n.spreadsheet-color-panel {\\n  padding: 10px;\\n  width: 100%;\\n}\\n.spreadsheet-color-panel table {\\n  border-collapse: separate;\\n  border-spacing: 0;\\n  border: none;\\n}\\n.spreadsheet-color-panel table tr td {\\n  padding: 0;\\n  border: none;\\n}\\n.spreadsheet-color-panel .color-cell {\\n  width: 20px;\\n  height: 20px;\\n  margin: 3px;\\n}\\n.spreadsheet-color-panel .color-cell:hover {\\n  box-shadow: 0 0 2px rgba(0, 0, 0, 0.8);\\n}\\n.spreadsheet-icon {\\n  height: 18px;\\n  width: 18px;\\n  margin: 0px 4px 3px 3px;\\n  direction: ltr;\\n  text-align: left;\\n  user-select: none;\\n  vertical-align: middle;\\n  overflow: hidden;\\n  position: relative;\\n  display: inline-block;\\n}\\n.spreadsheet-icon-img {\\n  background-image: url(\" + escape(require(\"../assets/sprite.svg\")) + \");\\n  position: absolute;\\n  width: 262px;\\n  height: 444px;\\n  opacity: 0.55;\\n}\\n.spreadsheet-icon-img.undo {\\n  left: 0;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.redo {\\n  left: -18px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.print {\\n  left: -36px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.paintformat {\\n  left: -54px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.clearformat {\\n  left: -72px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.bold {\\n  left: -90px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.italic {\\n  left: -108px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.underline {\\n  left: -126px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.strikethrough {\\n  left: -144px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.text-color {\\n  left: -162px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.cell-color {\\n  left: -180px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.merge {\\n  left: -198px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.align-left {\\n  left: -216px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.align-center {\\n  left: -234px;\\n  top: 0;\\n}\\n.spreadsheet-icon-img.align-right {\\n  left: 0;\\n  top: -18px;\\n}\\n.spreadsheet-icon-img.valign-top {\\n  left: -18px;\\n  top: -18px;\\n}\\n.spreadsheet-icon-img.valign-middle {\\n  left: -36px;\\n  top: -18px;\\n}\\n.spreadsheet-icon-img.valign-bottom {\\n  left: -54px;\\n  top: -18px;\\n}\\n.spreadsheet-icon-img.textwrap {\\n  left: -72px;\\n  top: -18px;\\n}\\n.spreadsheet-icon-img.autofilter {\\n  left: -90px;\\n  top: -18px;\\n}\\n.spreadsheet-icon-img.formula {\\n  left: -108px;\\n  top: -18px;\\n}\\n.spreadsheet-icon-img.arrow-down {\\n  left: -126px;\\n  top: -18px;\\n}\\n.spreadsheet-icon-img.arrow-right {\\n  left: -144px;\\n  top: -18px;\\n}\\n\", \"\"]);\n\n// exports\n","module.exports = function escape(url) {\n    if (typeof url !== 'string') {\n        return url\n    }\n    // If url is already wrapped in quotes, remove them\n    if (/^['\"].*['\"]$/.test(url)) {\n        url = url.slice(1, -1);\n    }\n    // Should url be wrapped?\n    // See https://drafts.csswg.org/css-values-3/#urls\n    if (/[\"'() \\t\\n]/.test(url)) {\n        return '\"' + url.replace(/\"/g, '\\\\\"').replace(/\\n/g, '\\\\n') + '\"'\n    }\n\n    return url\n}\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n","module.exports = __webpack_public_path__ + \"13b240062f9cf9a7f4131b86a426f140.svg\";","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getTarget = function (target) {\n  return document.querySelector(target);\n};\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(target) {\n                // If passing function in options, then use it for resolve \"head\" element.\n                // Useful for Shadow Root style i.e\n                // {\n                //   insertInto: function () { return document.querySelector(\"#foo\").shadowRoot }\n                // }\n                if (typeof target === 'function') {\n                        return target();\n                }\n                if (typeof memo[target] === \"undefined\") {\n\t\t\tvar styleTarget = getTarget.call(this, target);\n\t\t\t// Special case to return head of iframe instead of iframe itself\n\t\t\tif (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n\t\t\t\ttry {\n\t\t\t\t\t// This will throw an exception if access to iframe is blocked\n\t\t\t\t\t// due to cross-origin restrictions\n\t\t\t\t\tstyleTarget = styleTarget.contentDocument.head;\n\t\t\t\t} catch(e) {\n\t\t\t\t\tstyleTarget = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemo[target] = styleTarget;\n\t\t}\n\t\treturn memo[target]\n\t};\n})();\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton && typeof options.singleton !== \"boolean\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n        if (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else if (typeof options.insertAt === \"object\" && options.insertAt.before) {\n\t\tvar nextSibling = getElement(options.insertInto + \" \" + options.insertAt.before);\n\t\ttarget.insertBefore(style, nextSibling);\n\t} else {\n\t\tthrow new Error(\"[Style Loader]\\n\\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\\n Must be 'top', 'bottom', or Object.\\n (https://github.com/webpack-contrib/style-loader#insertat)\\n\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\toptions.attrs.type = \"text/css\";\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\toptions.attrs.type = \"text/css\";\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = options.transform(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/|\\s*$)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n","import { Element, h } from \"./base/element\";\nimport { Spreadsheet, SpreadsheetData } from '../core/index'\nimport { Editor } from './editor';\nimport { Selector, DashedSelector } from './selector';\nimport { Resizer } from './resizer';\nimport { Editorbar } from \"./editorbar\";\nimport { Toolbar } from \"./toolbar\";\nimport { ContextMenu } from \"./contextmenu\";\nimport { Cell, getStyleFromCell } from \"../core/cell\";\nimport { formatRenderHtml } from \"../core/format\";\nimport { formulaRender } from \"../core/formula\";\nimport { bind } from \"./event\";\n\ninterface Map<T> {\n  [key: string]: T\n}\n\nexport interface TableOption {\n  height: () => number,\n  width: () => number,\n  mode: 'design' | 'write' | 'read';\n}\n\nexport class Table {\n  cols: Map<Array<Element>> = {};\n  firsttds: Map<Array<Element>> = {};\n  tds: Map<Element> = {};\n  ths: Map<Element> = {};\n  ss: Spreadsheet;\n  formulaCellIndexs: Set<string> = new Set(); // è¡¨è¾¾å¼ååæ ¼set\n\n  el: Element;\n  header: Element;\n  body: Element;\n  fixedLeftBody: Element | null = null;\n\n  editor: Editor | null = null;\n  rowResizer: Resizer | null = null;\n  colResizer: Resizer | null = null;\n\n  contextmenu: ContextMenu | null = null;\n\n  selector: Selector;\n  dashedSelector: DashedSelector;\n  state: 'copy' | 'cut' | 'copyformat' | null = null;\n\n  currentIndexs: [number, number] | null = null;\n\n  // å½åç¨æ·æ¯å¦ç¦ç¹åtableä¸\n  focusing: boolean = false;\n\n  // change\n  change: (data: SpreadsheetData) => void = () => {}\n  editorChange: (v: Cell) => void = (v) => {}\n  clickCell: (rindex: number, cindex: number, v: Cell | null) => void = (rindex, cindex, v) => {}\n\n  constructor (ss: Spreadsheet, public options: TableOption) {\n    this.ss = ss;\n    this.ss.change = (data) => {\n      this.change(data)\n    }\n\n    if (options.mode !== 'read') {\n      this.editor = new Editor(ss.defaultRowHeight(), ss.formulas)\n      this.editor.change = (v: Cell) => this.editorChange(v)\n    }\n\n    if (options.mode === 'design') {\n      this.rowResizer = new Resizer(false, (index, distance) => this.changeRowResizer(index, distance))\n      this.colResizer = new Resizer(true, (index, distance) => this.changeColResizer(index, distance))\n      this.contextmenu = new ContextMenu(this)\n    }\n\n    this.selector = new Selector(this.ss, this);\n    this.selector.change = () => this.selectorChange();\n    this.selector.changeCopy = (e, arrow, startRow, startCol, stopRow, stopCol) => {\n      this.selectorChangeCopy(e, arrow, startRow, startCol, stopRow, stopCol);\n    }\n    this.dashedSelector = new DashedSelector();\n\n    this.el = h().class('spreadsheet-table').children([\n      this.colResizer && this.colResizer.el || '',\n      this.rowResizer && this.rowResizer.el || '',\n      this.buildFixedLeft(),\n      this.header = this.buildHeader(),\n      this.body = this.buildBody()\n    ]).on('contextmenu', (evt) => {\n      evt.returnValue = false\n      evt.preventDefault();\n    });\n\n    bind('resize', (evt: any) => {\n      this.header.style('width', `${this.options.width()}px`)\n      this.body.style('width', `${this.options.width()}px`)\n      if (this.options.mode !== 'read') {\n        this.body.style('height', `${this.options.height()}px`)\n      }\n    })\n\n    bind('click', (evt: any) => {\n      // console.log('::::::::', this.el.contains(evt.target))\n      this.focusing = this.el.parent().contains(evt.target)\n    })\n\n    // bind ctrl + c, ctrl + x, ctrl + v\n    bind('keydown', (evt: any) => {\n\n      if (!this.focusing) {\n        return\n      }\n\n      // console.log('::::::::', evt)\n      if (!this.focusing) return;\n\n      // ctrlKey\n      if (evt.ctrlKey && evt.target.type !== 'textarea' && this.options.mode !== 'read') {\n        // ctrl + c\n        if (evt.keyCode === 67) {\n          this.copy();\n          evt.returnValue = false\n        }\n        // ctrl + x\n        if (evt.keyCode === 88) {\n          this.cut();\n          evt.returnValue = false\n        }\n        // ctrl + v\n        if (evt.keyCode === 86) {\n          this.paste();\n          evt.returnValue = false\n        }\n      } else {\n        // console.log('>>>>>>>>>>>>>>', evt)\n        switch (evt.keyCode) {\n          case 37: // left\n            this.moveLeft()\n            evt.returnValue = false\n            break;\n          case 38: // up\n            this.moveUp()\n            evt.returnValue = false\n            break;\n          case 39: // right\n            this.moveRight()\n            evt.returnValue = false\n            break;\n          case 40: // down\n            this.moveDown()\n            evt.returnValue = false\n            break;\n          case 9: // tab\n            this.moveRight();\n            evt.returnValue = false\n            break;\n          case 13:\n            this.moveDown();\n            evt.returnValue = false\n            break;\n        }\n      \n\n        // è¾å¥a-zA-Z1-9\n        if (this.options.mode !== 'read') {\n          if (evt.keyCode >= 65 && evt.keyCode <= 90 || evt.keyCode >= 48 && evt.keyCode <= 57 || evt.keyCode >= 96 && evt.keyCode <= 105 || evt.keyCode == 187) {\n            // if (this.currentIndexs) {\n            // console.log('::::::::', evt.target.type)\n            if (evt.target.type !== 'textarea') {\n              this.ss.cellText(evt.key, (rindex, cindex, cell) => {\n                if (this.editor) {\n                  const td = this.td(rindex, cindex)\n                  td.html(this.renderCell(rindex, cindex, cell))\n                  this.editor.set(td.el, this.ss.currentCell())\n                }\n              })\n            }\n          }\n        }\n\n      }\n      \n    });\n  }\n\n  reload () {\n    this.firsttds = {}\n    this.el.html('')\n    this.el.children([\n      this.colResizer && this.colResizer.el || '',\n      this.rowResizer && this.rowResizer.el || '',\n      this.buildFixedLeft(),\n      this.header = this.buildHeader(),\n      this.body = this.buildBody()\n    ]);\n  }\n  \n  private moveLeft () {\n    if (this.currentIndexs && this.currentIndexs[1] > 0) {\n      this.currentIndexs[1] -= 1\n      this.moveSelector('left')\n    }\n  }\n  private moveUp () {\n    if (this.currentIndexs && this.currentIndexs[0] > 0) {\n      this.currentIndexs[0] -= 1\n      this.moveSelector('up')\n    }\n  }\n  private moveDown () {\n    if (this.currentIndexs && this.currentIndexs[0] < this.ss.rows(this.options.mode === 'read').length) {\n      this.currentIndexs[0] += 1\n      this.moveSelector('down')\n    }\n  }\n  private moveRight () {\n    if (this.currentIndexs && this.currentIndexs[1] < this.ss.cols().length) {\n      this.currentIndexs[1] += 1\n      this.moveSelector('right')\n    }\n  }\n\n  // ç§»å¨éæ¡\n  private moveSelector (direction: 'right' | 'left' | 'up' | 'down') {\n    if (this.currentIndexs) {\n      const [rindex, cindex] = this.currentIndexs\n      const td = this.td(rindex, cindex)\n      // console.log('move.td:', td)\n      if (td) {\n        this.selector.setCurrentTarget(td.el)\n        const bodyWidth = this.options.width()\n        const bodyHeight = this.options.height()\n        const {left, top, width, height} = td.offset()\n        // console.log(this.body.el.scrollLeft, ', body-width:', bodyWidth, ', left:', left, ', width=', width)\n        const leftDiff = left + width - bodyWidth\n        if (leftDiff > 0 && direction === 'right') {\n            this.body.el.scrollLeft = leftDiff + 15\n        }\n        if (direction === 'left' && this.body.el.scrollLeft + 60 > left) {\n          this.body.el.scrollLeft -= (this.body.el.scrollLeft + 60 - left)\n        }\n        if (direction === 'up' && this.body.el.scrollTop > top) {\n          this.body.el.scrollTop -= (this.body.el.scrollTop - top)\n        }\n        if (direction === 'down' && top + height - bodyHeight > 0) {\n          this.body.el.scrollTop = top + height - bodyHeight + 15;\n        }\n\n        this.mousedownCell(rindex, cindex)\n      }\n      \n    }\n  }\n\n  setValueWithText (v: Cell) {\n    // console.log('setValueWithText: v = ', v)\n    if (this.currentIndexs) {\n      this.ss.cellText(v.text, (rindex, cindex, cell) => {\n        this.td(rindex, cindex).html(this.renderCell(rindex, cindex, cell))\n      })\n    }\n    this.editor && this.editor.setValue(v)\n  }\n\n  setTdWithCell (rindex: number, cindex: number, cell: Cell, autoWordWrap = true) {\n    this.setTdStyles(rindex, cindex, cell);\n    this.setRowHeight(rindex, cindex, autoWordWrap);\n    this.td(rindex, cindex).html(this.renderCell(rindex, cindex, cell));\n  }\n\n  setCellAttr (k: keyof Cell, v: any) {\n    // console.log('::k:', k, '::v:', v)\n    this.ss.cellAttr(k, v, (rindex, cindex, cell) => {\n      // console.log(':rindex:', rindex, '; cindex:', cindex, '; cell: ', cell)\n      this.setTdWithCell(rindex, cindex, cell, k === 'wordWrap' && v);\n    })\n    this.editor && this.editor.setStyle(this.ss.currentCell())\n  }\n\n  undo (): boolean {\n    return this.ss.undo((rindex, cindex, cell) => {\n      // console.log('>', rindex, ',', cindex, '::', cell)\n      this.setTdStylesAndAttrsAndText(rindex, cindex, cell)\n    })\n  }\n  redo (): boolean {\n    return this.ss.redo((rindex, cindex, cell) => {\n      this.setTdStylesAndAttrsAndText(rindex, cindex, cell)\n    })\n  }\n  private setTdStylesAndAttrsAndText (rindex: number, cindex: number, cell: Cell) {\n    let td = this.td(rindex, cindex);\n    this.setTdStyles(rindex, cindex, cell);\n    this.setTdAttrs(rindex, cindex, cell);\n    // console.log('txt>>>:', this.renderCell(rindex, cindex, cell))\n    td.html(this.renderCell(rindex, cindex, cell));\n  }\n\n  copy () {\n    this.ss.copy();\n    this.dashedSelector.set(this.selector);\n    this.state = 'copy';\n  }\n\n  cut () {\n    this.ss.cut();\n    this.dashedSelector.set(this.selector);\n    this.state = 'cut';\n  }\n\n  copyformat () {\n    this.ss.copy();\n    this.dashedSelector.set(this.selector);\n    this.state = 'copyformat';\n  }\n\n  paste () {\n    // console.log('state: ', this.state, this.ss.select)\n    if (this.state !== null && this.ss.select) {\n      this.ss.paste((rindex, cindex, cell) => {\n        // console.log('rindex: ', rindex, ', cindex: ', cindex);\n        let td = this.td(rindex, cindex);\n        this.setTdStyles(rindex, cindex, cell);\n        this.setTdAttrs(rindex, cindex, cell);\n        if (this.state === 'cut' || this.state === 'copy') {\n          td.html(this.renderCell(rindex, cindex, cell));\n        }\n      }, this.state, (rindex, cindex, cell) => {\n        let td = this.td(rindex, cindex);\n        this.setTdStyles(rindex, cindex, cell);\n        this.setTdAttrs(rindex, cindex, cell);\n        td.html('');\n      });\n      this.selector.reload();\n    }\n\n    if (this.state === 'copyformat') {\n      this.state = null;\n    } else if (this.state === 'cut') {\n      this.state = null;  \n    } else if (this.state === 'copy') {\n      // this.ss.paste()\n    }\n    \n    this.dashedSelector.hide();\n  }\n\n  clearformat () {\n    this.ss.clearformat((rindex, cindex, cell) => {\n      this.td(rindex, cindex)\n        .removeAttr('rowspan')\n        .removeAttr('colspan')\n        .styles({}, true)\n        .show(true);\n    })\n  }\n\n  merge () {\n    this.ss.merge((rindex, cindex, cell) => {\n      // console.log(rindex, cindex, '>>>', this.table.td(rindex, cindex))\n      this.setTdAttrs(rindex, cindex, cell).show(true)\n    }, (rindex, cindex, cell) => {\n      this.setTdAttrs(rindex, cindex, cell).show(true)\n    }, (rindex, cindex, cell) => {\n      let td = this.td(rindex, cindex)\n      !cell.invisible ? td.show(true) : td.hide()\n    })\n  }\n\n  // insert\n  insert (type: 'row' | 'col', amount: number) {\n    if (type === 'col') {\n      // insert col\n    } else if (type === 'row') {\n      // insert row\n    }\n    this.ss.insert(type, amount, (rindex, cindex, cell) => {\n      this.setTdStylesAndAttrsAndText(rindex, cindex, cell)\n    })\n  }\n\n  td (rindex: number, cindex: number): Element {\n    const td = this.tds[`${rindex}_${cindex}`]\n    return td\n  }\n\n  private selectorChange () {\n    if (this.state === 'copyformat') {\n      this.paste();\n    }\n  }\n\n  private selectorChangeCopy (evt: any, arrow: 'bottom' | 'top' | 'left' | 'right', startRow: number, startCol: number, stopRow: number, stopCol: number) {\n    this.ss.batchPaste(arrow, startRow, startCol, stopRow, stopCol, evt.ctrlKey, (rindex, cindex, cell) => {\n      this.setTdStyles(rindex, cindex, cell);\n      this.setTdAttrs(rindex, cindex, cell);\n      this.td(rindex, cindex).html(this.renderCell(rindex, cindex, cell));\n    })\n  }\n\n  private renderCell (rindex: number, cindex: number, cell: Cell | null): string {\n    if (cell) {\n      const setKey = `${rindex}_${cindex}`\n      // console.log('text:', setKey, cell.text && cell.text)\n      if (cell.text && cell.text[0] === '=') {\n        this.formulaCellIndexs.add(setKey)\n      } else {\n        if (this.formulaCellIndexs.has(setKey)) {\n          this.formulaCellIndexs.delete(setKey)\n        }\n\n        this.reRenderFormulaCells()\n      }\n      return formatRenderHtml(cell.format, this._renderCell(cell))\n    }\n    return '';\n  }\n  private _renderCell (cell: Cell | null): string {\n    if (cell) {\n      let text = cell.text || '';\n      return formulaRender(text, (rindex, cindex) => this._renderCell(this.ss.getCell(rindex, cindex)))\n    }\n    return '';\n  }\n  private reRenderFormulaCells () {\n    // console.log('formulaCellIndex: ', this.formulaCellIndexs)\n    this.formulaCellIndexs.forEach(it => {\n      let rcindexes = it.split('_')\n      const rindex = parseInt(rcindexes[0])\n      const cindex = parseInt(rcindexes[1])\n      // console.log('>>>', this.ss.data, this.ss.getCell(rindex, cindex))\n      const text = this.renderCell(rindex, cindex, this.ss.getCell(rindex, cindex))\n      this.td(rindex, cindex).html(text);\n    })\n  }\n\n  private setRowHeight (rindex: number, cindex: number, autoWordWrap: boolean) {\n    // console.log('rowHeight: ', this.td(rindex, cindex).offset().height, ', autoWordWrap:', autoWordWrap)\n    // éårindexè¡çææååæ ¼ï¼è®¡ç®æå¤§é«åº¦\n    if (autoWordWrap === false) {\n      return ;\n    }\n    const cols = this.ss.cols()\n    const td = this.td(rindex, cindex)\n    let h = td.offset().height\n    console.log('h:', h)\n    const tdRowspan = td.attr('rowspan')\n    if (tdRowspan) {\n      for (let i = 1; i < parseInt(tdRowspan); i++) {\n        let firsttds = this.firsttds[(rindex + i) +'']\n        firsttds && (h -= parseInt(firsttds[0].attr('height') || 0) + 1)\n      }\n    }\n    // console.log('after.h:', h)\n    this.changeRowHeight(rindex, h - 1);\n  }\n\n  private setTdStyles (rindex: number, cindex: number, cell: Cell): Element {\n    return this.td(rindex, cindex).styles(getStyleFromCell(cell), true)\n  }\n  private setTdAttrs (rindex: number, cindex: number, cell: Cell): Element {\n    return this.td(rindex, cindex)\n      .attr('rowspan', cell.rowspan || 1)\n      .attr('colspan', cell.colspan || 1);\n  }\n\n  private changeRowHeight (index: number, h: number) {\n    if (h <= this.ss.defaultRowHeight()) return\n    this.ss.row(index, h)\n    const firstTds = this.firsttds[index+'']\n    if (firstTds) {\n      firstTds.forEach(td => td.attr('height', h))\n    }\n    this.selector.reload()\n    this.editor && this.editor.reload()\n  }\n  private changeRowResizer (index: number, distance: number) {\n    const h = this.ss.row(index).height + distance\n    this.changeRowHeight(index, h);\n  }\n  private changeColResizer (index: number, distance: number) {\n    const w = this.ss.col(index).width + distance\n    if (w <= 50) return\n    this.ss.col(index, w)\n    const cols = this.cols[index+'']\n    if (cols) {\n      cols.forEach(col => col.attr('width', w))\n    }\n    this.selector.reload()\n    this.editor && this.editor.reload()\n  }\n\n  private buildColGroup (lastColWidth: number): Element {\n    const cols = this.ss.cols();\n    return h('colgroup').children([\n      h('col').attr('width', '60'),\n      ...cols.map((col, index) => {\n        let c = h('col').attr('width', col.width)\n        this.cols[index+''] = this.cols[index+''] || []\n        this.cols[index+''].push(c)\n        return c; \n      }),\n      h('col').attr('width', lastColWidth)\n    ])\n  }\n\n  private buildFixedLeft (): Element {\n    const rows = this.ss.rows(this.options.mode === 'read');\n    return h().class('spreadsheet-fixed')\n    .style('width', '60px')\n    .children([\n      h().class('spreadsheet-fixed-header').child(h('table').child(\n        h('thead').child(\n          h('tr').child(\n            h('th').child('-')\n          )\n        ),\n      )),\n      this.fixedLeftBody = \n      h().class('spreadsheet-fixed-body')\n      .style('height', `${this.options.mode === 'read' ? 'auto' : this.options.height() - 18}px`)\n      .children([\n        h('table').child(\n          h('tbody').children(\n            rows.map((row, rindex) => {\n              let firstTd = h('td').attr('height', `${row.height}`).child(`${rindex + 1}`)\n                .on('mouseover', (evt: Event) => this.rowResizer && this.rowResizer.set(evt.target, rindex, this.body.el.scrollTop));\n              this.firsttdsPush(rindex, firstTd)\n              return h('tr').child(firstTd)\n            })\n          )\n        )\n      ])\n    ])\n  }\n\n  private buildHeader (): Element {\n    const cols = this.ss.cols();\n    const thead = h('thead').child(\n      h('tr').children([\n        h('th'),\n        ...cols.map((col, index) => {\n          let th = h('th').child(col.title).on('mouseover', (evt: Event) => {\n            console.log(evt)\n            this.colResizer && this.colResizer.set(evt.target, index, this.body.el.scrollLeft)\n          });\n          this.ths[index + ''] = th;\n          return th;\n        }),\n        h('th')\n      ]\n    ))\n    return h().class('spreadsheet-header').style('width', `${this.options.width()}px`).children([\n      h('table').children([this.buildColGroup(15), thead])\n    ])\n  }\n\n  private mousedownCell (rindex: number, cindex: number) {\n    if (this.editor) {\n      const editorValue = this.editor.value\n      if (this.currentIndexs && this.editor.target && editorValue) {\n        // console.log(':::editorValue:', editorValue)\n        const oldCell = this.ss.cellText(editorValue.text, (_rindex, _cindex, _cell: Cell) => {\n          this.td(_rindex, _cindex).html(this.renderCell(_rindex, _cindex, _cell))\n        });\n        // const oldTd = this.td(this.currentIndexs[0], this.currentIndexs[1]);\n        // oldTd.html(this.renderCell(editorValue))\n        if (oldCell) {\n          // è®¾ç½®åå®¹ä¹åï¼è·åé«åº¦è®¾ç½®è¡é«\n          if (oldCell.wordWrap) {\n            this.setRowHeight(this.currentIndexs[0], this.currentIndexs[1], true)\n          }\n          // console.log('old.td.offset:', oldCell)\n          // this.editorChange(oldCell)\n        }\n      }\n      this.editor.clear()\n    }\n\n    this.currentIndexs = [rindex, cindex]\n    const cCell = this.ss.currentCell([rindex, cindex])\n    this.clickCell(rindex, cindex, cCell)\n  }\n\n  private editCell(rindex: number, cindex: number) {\n    const td = this.td(rindex, cindex)\n    this.editor && this.editor.set(td.el, this.ss.currentCell())\n  }\n\n  private buildBody () {\n    const rows = this.ss.rows(this.options.mode === 'read');\n    const cols = this.ss.cols();\n\n    const mousedown = (rindex: number, cindex: number, evt: any) => {\n      const {select} = this.ss\n      if (evt.button === 2) {\n        // show contextmenu\n        console.log(':::evt:', evt)\n        this.contextmenu && this.contextmenu.set(evt)\n        if (select && select.contains(rindex, cindex)) {\n          return\n        }\n      }\n      // left key\n      this.selector.mousedown(evt)\n      this.mousedownCell(rindex, cindex)\n      this.focusing = true\n    }\n\n    const dblclick = (rindex: number, cindex: number) => {\n      this.editCell(rindex, cindex)\n    }\n\n    const scrollFn = (evt: any) => {\n      this.header.el.scrollLeft = evt.target.scrollLeft\n      this.fixedLeftBody && (this.fixedLeftBody.el.scrollTop = evt.target.scrollTop)\n      // console.log('>>>>>>>>scroll...', this.header, evt.target.scrollLeft, evt.target.scrollHeight)\n    }\n\n    const tbody = h('tbody').children(rows.map((row, rindex) => {\n      let firstTd = h('td').attr('height', `${row.height}`).child(`${rindex + 1}`);\n      this.firsttdsPush(rindex, firstTd)\n      return h('tr').children([\n        firstTd,\n        ...cols.map((col, cindex) => {\n          let cell = this.ss.getCell(rindex, cindex)\n          let td = h('td')\n            .child(this.renderCell(rindex, cindex, cell))\n            .attr('type', 'cell')\n            .attr('row-index', rindex + '')\n            .attr('col-index', cindex + '')\n            .attr('rowspan', cell && cell.rowspan || 1)\n            .attr('colspan', cell && cell.colspan || 1)\n            .styles(getStyleFromCell(cell), true)\n            .on('mousedown', (evt: any) => mousedown(rindex, cindex, evt))\n            .on('dblclick', dblclick.bind(null, rindex, cindex));\n          this.tds[`${rindex}_${cindex}`] = td\n          return td;\n        }),\n        h('td')\n      ])\n    }));\n\n    return h().class('spreadsheet-body')\n      .on('scroll', scrollFn)\n      .style('height', `${this.options.mode === 'read' ? 'auto' : this.options.height()}px`)\n      .style('width', `${this.options.width()}px`)\n      .children([\n        h('table').children([this.buildColGroup(0), tbody]),\n        this.editor && this.editor.el || '',\n        this.selector.el,\n        this.contextmenu && this.contextmenu.el || '',\n        this.dashedSelector.el\n      ]\n    )\n  }\n\n  // åå°¾é¨æ·»å è¡\n  private addRow (num = 1) {\n    if (num > 0) {\n\n    }\n  }\n\n  private firsttdsPush (index: number, el: Element) {\n    this.firsttds[`${index}`] = this.firsttds[`${index}`] || []  \n    this.firsttds[`${index}`].push(el)\n  }\n\n}","import { Element, h } from \"./base/element\";\nimport { Suggest } from \"./base/suggest\";\nimport { Cell, getStyleFromCell } from \"../core/cell\"\nimport { Formula } from \"../core/formula\";\n\nexport class Editor {\n  el: Element;\n  target: HTMLElement | null = null; // éä¸­çå½åçelement\n  value: Cell | null = null; // éä¸­çå½åçcell\n  editor: Element;\n  textarea: Element;\n  textline: Element; // è®¡ç®è¾å¥ææ¬çå®½åº¦ç¨çelement\n  suggest: Suggest; // autocomplete show\n\n  change: (v: Cell) => void = (v) => {};\n  constructor (public defaultRowHeight: number, public formulas : Array<Formula>) {\n    const suggestList: any = formulas.map(it => [it.key, it.title])\n    this.el = h().children([this.editor = h().class('spreadsheet-editor').children([\n        this.textarea = h('textarea')\n          .on('keydown', (evt: any) => this.inputKeydown(evt))\n          .on('input', (evt: Event) => this.inputChange(evt)),\n        this.textline = h().styles({visibility: 'hidden', overflow: 'hidden', position: 'fixed', top: '0', left: '0'})\n      ])\n    , this.suggest = new Suggest(suggestList, 180)]).hide()\n\n    this.el.on('keydown', (evt: any) => {\n      if (evt.keyCode !== 13 && evt.keyCode !== 9) {\n        evt.stopPropagation();\n      }\n    })\n\n    this.suggest.itemClick = (it) => {\n      // console.log('>>>>>>>>>>>>', it)\n      const text = `=${it[0]}()`;\n      if (this.value) {\n        this.value.text = text\n      }\n      this.textarea.val(text);\n      this.textline.html(text);\n      this.setTextareaRange(text.length - 1)\n      // (<any>this.textarea.el).setSelectionRange(text.length + 1, text.length + 1);\n      // setTimeout(() => (<any>this.textarea.el).focus(), 10)\n    }\n  }\n\n  onChange (change: (v: Cell) => void) {\n    this.change = change\n  }\n\n  set (target: HTMLElement, value: Cell | null) {\n    // console.log('set::>>')\n    this.target = target;\n    const text = this.setValue(value)\n    this.el.show();\n    this.setTextareaRange(text.length)\n    // (<any>this.textarea.el).setSelectionRange(text.length, text.length);\n    // setTimeout(() => (<any>this.textarea.el).focus(), 10)\n    this.reload();\n  }\n\n  setValue (value: Cell | null): string {\n    this.setStyle(value);\n    if (value) {\n      this.value = value;\n      const text = value.text || '';\n      this.textarea.val(text);\n      this.textline.html(text);\n      return text\n    } else {\n      return '';\n    }\n  }\n  setStyle (value: Cell | null): void {\n    let attrs = {width: this.textarea.style('width'), height: this.textarea.style('height')}\n    this.textarea.styles(Object.assign(attrs, getStyleFromCell(value)), true)\n  }\n\n  clear () {\n    // console.log('clear:>>>')\n    this.el.hide();\n    this.target = null;\n    this.value = null;\n    this.textarea.val('')\n    this.textline.html('')\n  }\n\n  private setTextareaRange (position: number) {\n    setTimeout(() => {\n      (<any>this.textarea.el).setSelectionRange(position, position);\n      (<any>this.textarea.el).focus()\n    }, 10)\n  }\n\n  private inputKeydown (evt: any) {\n    if (evt.keyCode === 13) {\n      evt.preventDefault()\n    }\n  }\n\n  private inputChange (evt: any) {\n    const v = evt.target.value\n    if (this.value) {\n      this.value.text = v\n    } else {\n      this.value = {text: v}\n    }\n    this.change(this.value)\n    this.autocomplete(v);\n\n    this.textline.html(v);\n    this.reload()\n\n  }\n\n  private autocomplete (v: string) {\n    if (v[0] === '=') {\n      if (!v.includes('(')) {\n        const search = v.substring(1)\n        console.log(':::;search word:', search)\n        this.suggest.search(this.editor, this.textarea, search);\n      } else {\n        this.suggest.hide()\n      }\n    } else {\n      this.suggest.hide()\n    }\n  }\n\n  reload () {\n    // setTimeout(() => {\n      if (this.target) {\n        const { offsetTop, offsetLeft, offsetWidth, offsetHeight } = this.target\n        this.editor.styles({left: `${offsetLeft - 1}px`, top: `${offsetTop - 1}px`})\n        this.textarea.styles({width: `${offsetWidth - 8}px`, height: `${offsetHeight - 2}px`})\n        let ow = this.textline.offset().width + 16\n        // console.log(maxWidth, ow, '>>>>')\n        if (this.value) {\n          if (this.value.wordWrap) {\n            // å¦æååæ ¼èªå¨æ¢è¡ï¼é£ä¹å®½åº¦åºå®ï¼é«åº¦åå\n            // this.textarea.style('height', 'auto');\n            const h = (parseInt(ow / offsetWidth + '') + (ow % offsetWidth > 0 ? 1 : 0)) * this.defaultRowHeight;\n            if (h > offsetHeight) {\n              this.textarea.style('height', `${h}px`);\n            }\n          } else {\n            const clientWidth = document.documentElement.clientWidth\n            const maxWidth = clientWidth - offsetLeft - 24\n            if (ow > offsetWidth) {\n              if (ow > maxWidth) {\n                // console.log(':::::::::', ow, maxWidth)\n                const h = (parseInt(ow / maxWidth + '') + (ow % maxWidth > 0 ? 1 : 0)) * this.defaultRowHeight;\n                if (h > offsetHeight) {\n                  this.textarea.style('height', `${h}px`)\n                } else {\n                  this.textarea.style('height', `${offsetHeight}px`)\n                }\n                ow = maxWidth\n              }\n              this.textarea.style('width', `${ow}px`)\n            }\n          }\n        }\n        this.el.show()\n      }\n    // }, 0)\n    \n  }\n}","import { Element, h } from \"./element\";\nimport { buildItem } from \"./item\";\nimport { buildMenu } from \"./menu\";\nimport { bind, unbind } from \"../event\";\n\nexport class Suggest extends Element {\n  \n  filterList: Array<Element> = [];\n  currentIndex = 0;\n  target: Element | null = null;\n  evtTarget: Element | null = null;\n\n  itemClick: (it: [string, string]) => void = (it) => {}\n\n  constructor (public list: Array<[string, string]>, public width: number) {\n    super();\n    this.class('spreadsheet-suggest').hide()\n  }\n\n  private documentHandler (e: any) {\n    if (this.el.contains(e.target)) {\n      return false\n    }\n    this.hideAndRemoveEvents()\n  }\n  private documentKeydownHandler (e: any) {\n    console.log('keyCode: ', e)\n    if (this.filterList.length <= 0 && e.target.type !== 'textarea') return ;\n\n    switch (e.keyCode) {\n      case 37: // left\n        e.returnValue = false\n        break;\n      case 38: // up\n        this.filterList[this.currentIndex].deactive()\n        this.currentIndex--\n        if (this.currentIndex < 0) {\n          this.currentIndex = this.filterList.length - 1\n        }\n        this.filterList[this.currentIndex].active()\n        e.returnValue = false\n        e.stopPropagation();\n        break;\n      case 39: // right\n        e.returnValue = false\n        break;\n      case 40: // down\n        this.filterList[this.currentIndex].deactive()\n        this.currentIndex++\n        if (this.currentIndex > this.filterList.length - 1) {\n          this.currentIndex = 0\n        }\n        this.filterList[this.currentIndex].active()\n        e.returnValue = false\n        break;\n      case 13: // enter\n        this.filterList[this.currentIndex].el.click()\n        e.returnValue = false\n        break;\n    }\n    e.stopPropagation();\n  }\n\n  private hideAndRemoveEvents () {\n    this.hide()\n    this.removeEvents();\n  }\n  private removeEvents () {\n    if (this.evtTarget !== null) {\n      unbind('click', this.data('_outsidehandler'), this.evtTarget.el)\n      unbind('keydown', this.data('_keydownhandler'), this.evtTarget.el)\n    }\n  }\n\n  private clickItemHandler (it: [string, string]) {\n    // console.log('click.it: ', it)\n    this.itemClick(it)\n    this.hideAndRemoveEvents()\n  }\n\n\n  search (target: Element, input: Element, word: string) {\n    this.removeEvents()\n    this.target = target;\n    this.evtTarget = input;\n\n    const { left, top, width, height } = target.offset()\n    this.styles({left: `${left}px`, top: `${top + height + 2}px`, width: `${this.width}px`})\n\n    let lis: any = this.list\n    if (!/^\\s*$/.test(word)) {\n      lis = this.list.filter(it => it[0].startsWith(word.toUpperCase()))\n    }\n    lis = lis.map((it: [string, string]) => {\n      const item = buildItem().on('click', (evt) => this.clickItemHandler(it)).child(it[0])\n      if (it[1]) {\n        item.child(h().class('label').html(it[1]))\n      }\n      return item\n      // return `<div class=\"spreadsheet-item\" it-key=\"${it[0]}\">${it[0]}${it[1] ? '<div class=\"label\">'+it[1]+'</div>' : ''}</div>`\n    })\n\n    this.filterList = lis\n    this.currentIndex = 0\n\n    if (lis.length <= 0) {\n      lis = [buildItem().child('No Result')] // `<div class=\"spreadsheet-item disabled\">No Result</div>`\n    } else {\n      lis[0].active()\n\n      // clickoutside\n      this.data('_outsidehandler', (evt: Event) => {\n        this.documentHandler(evt)\n      })\n      this.data('_keydownhandler', (evt: any) => this.documentKeydownHandler(evt))\n      setTimeout(() => {\n        if (this.evtTarget !== null) {\n          bind('click', this.data('_outsidehandler'), this.evtTarget.el)\n          bind('keydown', this.data('_keydownhandler'), this.evtTarget.el)\n        }\n      }, 0)\n    }\n    this.html(``)\n    this.child(buildMenu().children(lis)).show()\n  }\n}","import { Element, h } from \"./base/element\";\nimport { bind, mouseMoveUp } from './event';\nimport { Spreadsheet } from \"../core/index\";\nimport { Table } from './table';\n\nexport class Selector {\n  topEl: Element;\n  rightEl: Element;\n  bottomEl: Element;\n  leftEl: Element;\n  areaEl: Element;\n  cornerEl: Element;\n  copyEl: Element;\n  el: Element;\n  _offset = {left: 0, top: 0, width: 0, height: 0};\n\n  startTarget: any;\n  endTarget: any;\n\n  change: () => void = () => {};\n  changeCopy: (evt: any, arrow: 'bottom' | 'top' | 'left' | 'right', startRow: number, startCol: number, stopRow: number, stopCol: number) => void \n    = (evt, arrow, startRow, startCol, stopRow, stopCol) => {};\n\n  constructor (public ss: Spreadsheet, public table: Table) {\n    this.topEl = h().class('top-border');\n    this.rightEl = h().class('right-border');\n    this.bottomEl = h().class('bottom-border');\n    this.leftEl = h().class('left-border');\n    this.areaEl = h().class('area-border');\n    this.cornerEl = h().class('corner').on('mousedown', (evt) => this.cornerMousedown(evt));\n    this.copyEl = h().class('copy-border');\n    this.el = h().class('spreadsheet-borders').children([\n      this.topEl,\n      this.rightEl,\n      this.bottomEl,\n      this.leftEl,\n      this.areaEl,\n      this.cornerEl,\n      this.copyEl.hide(),\n    ]).hide()\n  }\n\n  mousedown (evt: any) {\n    // console.log('>>>>>>>>selector>>')\n    // console.log(this, evt, evt.type, evt.detail, evt.buttons, evt.button)\n    if (evt.detail === 1 && evt.target.getAttribute('type') === 'cell') {\n      // console.log(evt.shiftKey)\n      if (evt.shiftKey) {\n        this.endTarget = evt.target\n        this.setOffset()\n        return\n      }\n      // Object.assign(this, {startTarget: evt.target, endTarget: evt.target})\n      // this.setOffset()\n      this.setCurrentTarget(evt.target)\n\n      mouseMoveUp((e: any) => {\n        if (e.buttons === 1 && e.target.getAttribute('type') === 'cell') {\n          this.endTarget = e.target\n          this.setOffset()\n        }\n      }, (e) => { this.change() })\n      // show el\n      this.el.show()\n    }\n  }\n\n  setCurrentTarget (target: HTMLElement) {\n    Object.assign(this, {startTarget: target, endTarget: target})\n    this.setOffset()\n  }\n\n  private cornerMousedown (evt: any) {\n    const { select } = this.ss\n    if (select === null) {\n      return ;\n    }\n    const [stopRow, stopCol] = select.stop;\n    const [startRow, startCol] = select.start;\n    \n    let boxRange:['bottom' | 'top' | 'left' | 'right', number, number, number, number] | null = null;\n    mouseMoveUp((e: any) => {\n      const rowIndex = e.target.getAttribute('row-index')\n      const colIndex = e.target.getAttribute('col-index')\n      if (rowIndex && colIndex) {\n        this.copyEl.show();\n        let rdiff = stopRow - rowIndex\n        let cdiff = stopCol - colIndex\n        let _rdiff = startRow - rowIndex\n        let _cdiff = startCol - colIndex\n        const {left, top, height, width} = this._offset;\n        // console.log(rdiff, cdiff, ',,,', _rdiff, _cdiff)\n        if (rdiff < 0) {\n          // bottom\n          // console.log('FCK=>bottom', this.rowsHeight(stopRow, stopRow + Math.abs(rdiff)), rdiff)\n          this.copyEl.styles({\n            left: `${left - 1}px`,\n            top: `${top - 1}px`,\n            width: `${width - 1}px`,\n            height: `${this.rowsHeight(stopRow - select.rowLen() + 1, stopRow + Math.abs(rdiff)) - 1}px`});\n          boxRange = ['bottom', stopRow + 1, startCol, stopRow + Math.abs(rdiff), stopCol]\n        } else if (cdiff < 0) {\n          // right\n          // console.log('FCK=>right')\n          this.copyEl.styles({\n            left: `${left - 1}px`,\n            top: `${top - 1}px`,\n            width: `${this.colsWidth(stopCol - select.colLen() + 1, stopCol + Math.abs(cdiff)) - 1}px`,\n            height: `${height - 1}px`});\n          boxRange = ['right', startRow, stopCol + 1, stopRow, stopCol + Math.abs(cdiff)]\n        } else if (_rdiff > 0) {\n          // top\n          // console.log('FCK=>top')\n          const h = this.rowsHeight(startRow - _rdiff, startRow - 1)\n          this.copyEl.styles({\n            left: `${left - 1}px`,\n            top: `${top - h - 1}px`,\n            width: `${width - 1}px`,\n            height: `${h - 1}px`});\n          boxRange = ['top', startRow - _rdiff, startCol, startRow - 1, stopCol]\n        } else if (_cdiff > 0) {\n          // left\n          // console.log('FCK=>left')\n          const w = this.colsWidth(startCol - _cdiff, startCol - 1)\n          this.copyEl.styles({\n            left: `${left - w - 1}px`,\n            top: `${top - 1}px`,\n            width: `${w - 1}px`,\n            height: `${height - 1}px`});\n          boxRange = ['left', startRow, startCol - _cdiff, stopRow, startCol - 1]\n        } else {\n          this.copyEl.styles({\n            left: `${left - 1}px`,\n            top: `${top - 1}px`,\n            width: `${width - 1}px`,\n            height: `${height - 1}px`});\n          boxRange = null\n        }\n      }\n    }, (e) => {\n      this.copyEl.hide()\n      if (boxRange !== null) {\n        const [arrow, startRow, startCol, stopRow, stopCol] = boxRange\n        this.changeCopy(e, arrow, startRow, startCol, stopRow, stopCol)\n      }\n    });\n  }\n\n  reload () {\n    this.setOffset()\n  }\n\n  private setOffset () {\n    if (this.startTarget === undefined) return ;\n    let { select } = this.ss\n\n    // console.log('select: ', select, this.table)\n    if (select) {\n      // console.log('clear>>>>>:::')\n      // clear\n      const [minRow, minCol] = select.start\n      const [maxRow, maxCol] = select.stop\n      _forEach(minRow, maxRow, this.table.firsttds, (e) => { e.deactive() })\n      _forEach(minCol, maxCol, this.table.ths, (e) => { e.deactive() })\n    }\n\n    select = this.ss.buildSelect(this.startTarget, this.endTarget)\n    const [minRow, minCol] = select.start\n    const [maxRow, maxCol] = select.stop\n    // let height = 0, width = 0;\n    const height = this.rowsHeight(minRow, maxRow, (e) => e.active())\n    // _forEach(minRow, maxRow, this.table.firsttds, (e) => { \n    //   e.active()\n    //   height += parseInt(e.offset().height)\n    // })\n    // height /= 2\n    const width = this.colsWidth(minCol, maxCol, (e) => e.active())\n    // _forEach(minCol, maxCol, this.table.ths, (e) => {\n    //   e.active()\n    //   width += parseInt(e.offset().width)\n    // })\n\n    // console.log('>>', minRow, minCol, maxRow, maxCol, height, width)\n    const td = this.table.td(minRow, minCol)\n    if (td) {\n      // console.log('td:', td)\n      const {left, top} = td.offset()\n      this._offset = {left, top, width, height};\n\n      this.topEl.styles({left: `${left - 1}px`, top: `${top - 1}px`, width: `${width + 1}px`, height: '2px'})\n      this.rightEl.styles({left: `${left + width - 1}px`, top: `${top - 1}px`, width: '2px', height: `${height}px`})\n      this.bottomEl.styles({left: `${left - 1}px`, top: `${top + height - 1}px`, width: `${width}px`, height: '2px'})\n      this.leftEl.styles({left: `${left - 1}px`, top: `${top - 1}px`, width: '2px', height: `${height}px`})\n      this.areaEl.styles({left: `${left}px`, top: `${top}px`, width: `${width - 2}px`, height: `${height - 2}px`})\n      this.cornerEl.styles({left: `${left + width - 5}px`, top: `${top + height - 5}px`})\n    }\n  }\n  private rowsHeight (minRow:number, maxRow:number, cb: (e: Element) => void = (e) => {}): number {\n    let height = 0\n    _forEach(minRow, maxRow, this.table.firsttds, (e) => { \n      cb(e)\n      height += parseInt(e.offset().height)\n    })\n    height /= 2\n    return height\n  }\n  private colsWidth (minCol: number, maxCol: number, cb: (e: Element) => void = (e) => {}): number {\n    let width = 0\n    _forEach(minCol, maxCol, this.table.ths, (e) => {\n      cb(e)\n      width += parseInt(e.offset().width)\n    })\n    return width\n  }\n}\n\nconst _forEach = (start: number, stop: number, elements: {[key: string]: Array<Element> | Element}, cb: (e: Element) => void): void => {\n  for (let i = start; i <= stop; i++) {\n    const es = elements[i + ''];\n    if (es) {\n      if (es instanceof Element) {\n        cb(es)\n      } else {\n        es.forEach(e => cb(e))\n      }\n    }\n  }\n}\n\nexport class DashedSelector {\n  el: Element;\n  constructor () {\n    this.el = h().class('spreadsheet-borders dashed').hide();\n  }\n\n  set (selector: Selector) {\n    if (selector._offset) {\n      const { left, top, width, height } = selector._offset;\n      this.el\n        .style('left', `${left - 2}px`)\n        .style('top', `${top - 2}px`)\n        .style('width', `${width}px`)\n        .style('height', `${height}px`)\n        .show();\n    }\n  }\n\n  hide () {\n    this.el.hide();\n  }\n}\n","import { Element, h } from \"./base/element\";\nimport { mouseMoveUp } from './event';\n\nexport class Resizer {\n  el: Element;\n  resizer: Element;\n  resizerLine: Element;\n  moving: boolean = false;\n  index: number = 0;\n  constructor (public vertical: boolean, public change: (index: number, distance: number) => void) {\n    this.el = h().class('spreadsheet-resizer-wrapper').children([\n      this.resizer = h().class(`spreadsheet-resizer ${vertical ? 'vertical' : 'horizontal'}`)\n        .on('mousedown', (evt: Event) => this.mousedown(evt)),\n      this.resizerLine = h().class(`spreadsheet-resizer-line ${vertical ? 'vertical' : 'horizontal'}`).hide()\n    ])\n  }\n\n  set (target: any, index: number, scroll: number) {\n    if (this.moving) return ;\n    this.index = index\n    const { vertical } = this\n    const { offsetLeft, offsetTop, offsetHeight, offsetWidth, parentNode } = target\n    this.resizer.styles({\n      left: `${vertical ? offsetLeft + offsetWidth - 5 - scroll : offsetLeft}px`,\n      top: `${vertical ? offsetTop : offsetTop + offsetHeight - 5 + 24  - scroll}px`,\n      width: `${vertical ? 5 : offsetWidth}px`,\n      height: `${vertical ? offsetHeight : 5}px`\n    })\n    this.resizerLine.styles({\n      left: `${vertical ? offsetLeft + offsetWidth - scroll : offsetLeft}px`,\n      top: `${vertical ? offsetTop : offsetTop + offsetHeight + 24 - scroll}px`,\n      width: `${vertical ? 0 : parentNode.parentNode.parentNode.parentNode.parentNode.nextSibling.offsetWidth - 15}px`,\n      height: `${vertical ? parentNode.parentNode.parentNode.parentNode.nextSibling.offsetHeight + parentNode.offsetHeight : 0}px`\n    })\n    // this.el.show()\n  }\n\n  mousedown (evt: any) {\n    let startEvt = evt;\n    let distance = 0;\n    this.resizerLine.show()\n    mouseMoveUp((e: any) => {\n      this.moving = true\n      if (startEvt !== null && e.buttons === 1) {\n        if (this.vertical) {\n          const d = e.x - startEvt.x\n          distance += d\n          this.resizer.style('left', `${this.resizer.offset().left + d}px`)\n          this.resizerLine.style('left', `${this.resizerLine.offset().left + d}px`)\n        } else {\n          const d = e.y - startEvt.y\n          distance += d\n          this.resizer.style('top', `${this.resizer.offset().top + d}px`)\n          this.resizerLine.style('top', `${this.resizerLine.offset().top + d}px`)\n        }\n        startEvt = e\n      }\n    }, (e: any) => {\n      this.change(this.index, distance)\n      startEvt = null\n      this.resizerLine.hide()\n      distance = 0\n      this.moving = false\n    })\n  }\n}","import { Element, h } from \"./base/element\";\nimport { buildItem } from \"./base/item\";\nimport { buildMenu } from \"./base/menu\";\nimport { Table } from \"./table\"\n\nexport class ContextMenu {\n  el: Element;\n  constructor (public table: Table) {\n    this.el = h().class('spreadsheet-contextmenu')\n    .style('width', '160px')\n    .on('click', (evt: any) => this.el.hide())\n    .children([\n      buildMenu().children([\n        buildItem().on('click', (evt) => table.copy()).children(['copy', h().class('label').html('ctrl + c')]),\n        buildItem().on('click', (evt) => table.cut()).children(['cut', h().class('label').html('ctrl + x')]),\n        buildItem().on('click', (evt) => table.paste()).children(['paste', h().class('label').html('ctrl + v')]),\n        // h().class('spreadsheet-item-separator'),\n        // buildItem().on('click', (evt) => table.insert('row', 1)).html('insert row'),\n        // buildItem().on('click', (evt) => table.insert('col', 1)).html('insert col')\n      ])\n    ]).onClickOutside(() => {}).hide()\n    // clickoutside\n  }\n\n  set (evt: any) {\n    const { offsetLeft, offsetTop } = evt.target\n    const elRect = this.el.el.getBoundingClientRect()\n    // cal left top\n    const { clientWidth, clientHeight } = document.documentElement\n    let top = offsetTop + evt.offsetY\n    let left = offsetLeft + evt.offsetX\n\n    if (evt.clientY > clientHeight / 1.5) {\n      top -= elRect.height\n    }\n    if (evt.clientX > clientWidth / 1.5) {\n      left -= elRect.width\n    }\n    this.el.style('left', `${left}px`).style('top', `${top}px`).show()\n  }\n\n}","import { Element, h } from \"./base/element\";\nimport { Spreadsheet } from \"../core/index\";\nimport { Cell, getStyleFromCell, defaultCell } from '../core/cell';\nimport { Table } from './table';\nimport { buildItem, Item } from './base/item';\nimport { buildIcon } from './base/icon';\nimport { buildDropdown, Dropdown } from './base/dropdown';\nimport { buildMenu } from './base/menu';\nimport { buildColorPanel } from './base/colorPanel';\nimport { Font } from \"../core/font\";\nimport { Format } from \"../core/format\";\n\nexport class Toolbar {\n  el: Element;\n  defaultCell: Cell;\n\n  target: Element | null = null;\n  currentCell: Cell | null = null;\n\n  elUndo: Element;\n  elRedo: Element;\n  elPaintformat: Element;\n  elClearformat: Element;\n  elFormat: Dropdown;\n  elFont: Dropdown;\n  elFontSize: Dropdown;\n  elFontWeight: Element;\n  elFontStyle: Element;\n  elTextDecoration: Element;\n  elColor: Dropdown;\n  elBackgroundColor: Dropdown;\n  elMerge: Element;\n  elAlign: Dropdown;\n  elValign: Dropdown;\n  elWordWrap: Element;\n\n  change: (key: keyof Cell, v: any) => void = (key, v) => {}\n  redo: () => boolean = () => false\n  undo: () => boolean = () => false\n\n  constructor (public ss: Spreadsheet) {\n    this.defaultCell = ss.data.cell\n\n    this.el = h().class('spreadsheet-toolbar').child(\n        buildMenu('horizontal').children([\n          this.elUndo = this.buildUndo(),\n          this.elRedo = this.buildRedo(),\n          this.elPaintformat = this.buildPaintformat(),\n          this.elClearformat = this.buildClearformat(),\n          this.elFormat = this.buildFormats(),\n          this.buildSeparator(),\n          this.elFont = this.buildFonts(),\n          this.elFontSize = this.buildFontSizes(),\n          this.buildSeparator(),\n          this.elFontWeight = this.buildFontWeight(),\n          this.elFontStyle = this.buildFontStyle(),\n          this.elTextDecoration = this.buildTextDecoration(),\n          this.elColor = this.buildColor(),\n          this.buildSeparator(),\n          this.elBackgroundColor = this.buildBackgroundColor(),\n          this.elMerge = this.buildMerge(),\n          this.buildSeparator(),\n          this.elAlign = this.buildAligns(),\n          this.elValign = this.buildValigns(),\n          this.elWordWrap = this.buildWordWrap()\n        ])\n      )\n    ;\n  }\n\n  set (target: Element, cell: Cell | null) {\n    this.target = target\n    this.setCell(cell)\n  }\n\n  private setCell (cell: Cell | null) {\n    this.currentCell = cell\n    this.setCellStyle()\n  }\n\n  private setCellStyle () {\n    const { target, currentCell, defaultCell, ss } = this\n    // console.log(':::', currentCell)\n    if (target) {\n      // target.clearStyle()\n      // target.styles(getStyleFromCell(currentCell))\n      this.elFormat.title.html(ss.getFormat(currentCell !== null && currentCell.format || defaultCell.format).title);\n      this.elFont.title.html(ss.getFont(currentCell !== null && currentCell.font || defaultCell.font).title);\n      this.elFontSize.title.html((currentCell !== null && currentCell.fontSize || defaultCell.fontSize) + '');\n      this.elFontWeight.active(currentCell !== null && currentCell.bold !== undefined && currentCell.bold !== defaultCell.bold);\n      this.elFontStyle.active(currentCell !== null && currentCell.italic !== undefined && currentCell.italic !== defaultCell.italic);\n      this.elTextDecoration.active(currentCell !== null && currentCell.underline !== undefined && currentCell.underline !== defaultCell.underline);\n      this.elColor.title.style('border-bottom-color', currentCell !== null && currentCell.color || defaultCell.color);\n      this.elBackgroundColor.title.style('border-bottom-color', currentCell !== null && currentCell.backgroundColor || defaultCell.backgroundColor);\n      (<any>this.elAlign.title).replace(`align-${currentCell !== null && currentCell.align || defaultCell.align}`);\n      (<any>this.elValign.title).replace(`valign-${currentCell !== null && currentCell.valign || defaultCell.valign}`);\n      this.elWordWrap.active(currentCell !== null && currentCell.wordWrap !== undefined && currentCell.wordWrap !== defaultCell.wordWrap);\n      // console.log('select:', currentCell)\n      if ((currentCell !== null && currentCell.rowspan && currentCell.rowspan > 1)\n        || (currentCell !== null && currentCell.colspan && currentCell.colspan > 1)) {\n        this.elMerge.active(true);\n      } else {\n        this.elMerge.active(false);\n      }\n    }\n  }\n\n  setRedoAble (flag: boolean) {\n    flag ? this.elRedo.able() : this.elRedo.disabled()\n  }\n\n  setUndoAble (flag: boolean) {\n    flag ? this.elUndo.able() : this.elUndo.disabled()\n  }\n\n  private buildSeparator (): Element {\n    return h().class('spreadsheet-item-separator')\n  }\n  private buildAligns (): Dropdown {\n    const titleIcon = buildIcon(`align-${this.defaultCell.align}`)\n    const clickHandler = (it: string) => {\n      titleIcon.replace(`align-${it}`)\n      this.change('align', it)\n    }\n    return buildDropdown(titleIcon, '60px', [buildMenu().children(\n      ['left', 'center', 'right'].map(it => \n        buildItem()\n          .child(buildIcon(`align-${it}`).style('text-align', 'center'))\n          .on('click', clickHandler.bind(null, it))\n      )\n    )])\n  }\n  private buildValigns (): Dropdown {\n    const titleIcon = buildIcon(`valign-${this.defaultCell.valign}`)\n    const clickHandler = (it: string) => {\n      titleIcon.replace(`valign-${it}`)\n      this.change('valign', it)\n    }\n    return buildDropdown(titleIcon, '60px', [buildMenu().children(\n      ['top', 'middle', 'bottom'].map(it => \n        buildItem()\n          .child(buildIcon(`valign-${it}`).style('text-align', 'center'))\n          .on('click', clickHandler.bind(null, it))\n        )\n    )])\n  }\n  private buildWordWrap (): Element {\n    return buildIconItem('textwrap', (is) => this.change('wordWrap', is))\n  }\n  private buildFontWeight (): Element {\n    return buildIconItem('bold', (is) => this.change('bold', is))\n  }\n  private buildFontStyle (): Element {\n    return buildIconItem('italic', (is) => this.change('italic', is))\n  }\n  private buildTextDecoration (): Element {\n    return buildIconItem('underline', (is) => this.change('underline', is))\n  }\n  private buildMerge (): Element {\n    return buildIconItem('merge', (is) => this.change('merge', is))\n  }\n  private buildColor (): Dropdown {\n    const clickHandler = (color: string) => {\n      this.elColor.title.style('border-bottom-color', color)\n      this.change('color', color)\n    }\n    return buildDropdown(\n      buildIcon('text-color').styles({'border-bottom': `3px solid ${this.defaultCell.color}`, 'margin-top': '2px', height: '16px'}),\n      'auto',\n      [buildColorPanel(clickHandler)])\n  }\n  private buildBackgroundColor (): Dropdown {\n    const clickHandler = (color: string) => {\n      this.elBackgroundColor.title.style('border-bottom-color', color)\n      this.change('backgroundColor', color)\n    }\n    return buildDropdown(\n      buildIcon('cell-color').styles({'border-bottom': `3px solid ${this.defaultCell.backgroundColor}`, 'margin-top': '2px', height: '16px'}),\n      'auto',\n      [buildColorPanel(clickHandler)])\n  }\n  private buildUndo (): Element {\n    return buildItem().child(buildIcon('undo'))\n      .on('click', (evt) => {\n        this.undo() ? this.elUndo.able() : this.elUndo.disabled()\n      })\n      .disabled()\n  }\n  private buildRedo (): Element {\n    return buildItem().child(buildIcon('redo'))\n      .on('click', (evt) => {\n        this.redo() ? this.elRedo.able() : this.elRedo.disabled()\n      })\n      .disabled()\n  }\n  private buildPaintformat (): Element {\n    return buildIconItem('paintformat', (is) => { \n      this.change('paintformat', true);\n      this.elPaintformat.deactive();\n    })\n  }\n  private buildClearformat (): Element {\n    return buildIconItem('clearformat', (is) => { \n      this.change('clearformat', true);\n      this.elClearformat.deactive();\n    });\n  }\n  private buildFormats (): Dropdown {\n    const clickHandler = (it: Format) => {\n      this.elFormat.title.html(this.ss.getFormat(it.key).title);\n      this.change('format', it.key)\n    }\n    return buildDropdown(this.ss.getFormat(this.defaultCell.format).title, '250px', [buildMenu().children(\n      this.ss.formats.map(it => \n        buildItem()\n          .children([it.title, h().class('label').child(it.label||'')])\n          .on('click', clickHandler.bind(null, it))\n        )\n    )])\n  }\n  private buildFonts (): Dropdown {\n    const clickHandler = (it: Font) => {\n      this.elFont.title.html(it.title)\n      this.change('font', it.key)\n    }\n    return buildDropdown(this.ss.getFont(this.defaultCell.font).title, '170px', [buildMenu().children(\n      this.ss.fonts.map(it => { \n        return buildItem()\n          .child(it.title)\n          .on('click', clickHandler.bind(null, it))\n      })\n    )])\n  }\n  private buildFontSizes (): Dropdown {\n    const clickHandler = (it: number) => {\n      this.elFontSize.title.html(`${it}`)\n      this.change('fontSize', it)\n    }\n    return buildDropdown(this.defaultCell.fontSize + '', '70px', [buildMenu().children(\n      [6, 8, 10, 12, 14, 16, 18, 20, 22, 24, 30, 36].map(it => {\n        return buildItem()\n          .child(`${it}`)\n          .on('click', clickHandler.bind(null, it))\n      })\n    )])\n  }\n}\n\nconst buildIconItem = (iconName: string, change: (flag: boolean) => void) => {\n  const el = buildItem().child(buildIcon(iconName))\n  el.on('click', (evt) => {\n    let is = el.isActive()\n    is ? el.deactive() : el.active()\n    change(!is)\n  })\n  return el;\n}","import { Element, h } from \"./element\";\nimport { buildIcon } from \"./icon\";\n\nexport class Dropdown extends Element {\n  content: Element;\n  title: Element;\n\n  constructor (title: string | Element, width: string, contentChildren: Element[]) {\n    super();\n    this.class('spreadsheet-dropdown spreadsheet-item');\n\n    this.content = h().class('spreadsheet-dropdown-content')\n      .children(contentChildren)\n      .onClickOutside(() => this.deactive())\n      .on('click', (evt) => this.toggleHandler(evt))\n      .style('width', width).hide();\n\n    this.child(h().class('spreadsheet-dropdown-header').children([\n      this.title = typeof title === 'string' ? h().class('spreadsheet-dropdown-title').child(title) : title,\n      h().class('spreadsheet-dropdown-icon').on('click', (evt) => this.toggleHandler(evt)).child(buildIcon('arrow-down'))\n    ])).child(this.content);\n  }\n\n  toggleHandler (evt: Event) {\n    if (this.content.isHide()){\n      this.content.show()\n      this.active()\n    } else {\n      this.content.hide()\n      this.deactive()\n    }\n  }\n}\nexport function buildDropdown(title: string | Element, width: string, contentChildren: Element[]) {\n  return new Dropdown(title, width, contentChildren)\n}","import { Element, h } from \"./element\";\n\nconst colorss = [\n  ['#c00000', '#ff0000', '#ffc003', '#ffff00','#91d051', '#00af50', '#00b0f0', '#0070c0', '#002060', '#70309f'],\n  ['#ffffff', '#000000', '#e7e6e6', '#44546a', '#4472c4', '#ed7d31', '#a5a5a5', '#ffc003', '#5b9bd5', '#70ad47'],\n  ['#f4f5f8', '#848484', '#d0cece', '#d6dce4', '#d9e2f2', '#fae5d5', '#ededed', '#fff2cc', '#deebf6', '#e2efd9'],\n  ['#d8d8d8', '#595959', '#afabab', '#adb9ca', '#b4c6e7', '#f7cbac', '#dbdbdb', '#fee598', '#bdd7ee', '#c5e0b3'],\n  ['#bfbfbf', '#3f3f3f', '#757070', '#8496b0', '#8eaad8', '#f4b183', '#c9c9c9', '#ffd964', '#9dc2e5', '#a8d08d'],\n  ['#a5a5a5', '#262626', '#3a3838', '#333f4f', '#2f5496', '#c55b11', '#7b7b7b', '#bf9001', '#2e75b5', '#538135'],\n  ['#7e7e7e', '#0c0c0c', '#171616', '#232a35', '#1e3864', '#833d0b', '#525252', '#7e6000', '#1f4e79', '#375623']\n]\n\nexport class ColorPanel extends Element {\n\n  constructor (click: (color: string) => void) {\n    super();\n    this.class('spreadsheet-color-panel')\n    .child(\n      h('table').child(\n        h('tbody').children(\n          colorss.map(colors => {\n            return h('tr').children(\n              colors.map(color => {\n                return h('td').child(\n                  h()\n                    .class('color-cell')\n                    .on('click', click.bind(null, color))\n                    .style('background-color', color)\n                )\n              })\n            )\n          })\n        )));\n  }\n\n}\n\nexport function buildColorPanel (click: (color: string) => void) {\n  return new ColorPanel(click);\n}","import { Element, h } from \"./base/element\";\nimport { Cell } from \"../core/cell\";\nimport { mouseMoveUp } from \"./event\"\n\nexport class Editorbar {\n  el: Element;\n  value: Cell | null = null; // éä¸­çå½åçcell\n  textarea: Element;\n  label: Element;\n  change: (v: Cell) => void = (v) => {};\n  constructor () {\n    this.el = h().class('spreadsheet-editor-bar').children([\n      h().class('spreadsheet-formula-bar').children([\n        this.label = h().class('spreadsheet-formula-label'),\n        this.textarea = h('textarea').on('input', (evt) => this.input(evt))\n      ]),\n      // h().class('spreadsheet-formular-bar-resizer').on('mousedown', this.mousedown)\n    ])\n  }\n\n  set (title: string, value: Cell | null) {\n    this.label.html(title)\n    this.setValue(value)\n  }\n\n  setValue (value: Cell | null) {\n    this.value = value\n    this.textarea.val(value && value.text || '')\n  }\n\n  input (evt: any) {\n    const v = evt.target.value\n    \n    if (this.value) {\n      this.value.text = v\n    } else {\n      this.value = {text: v}\n    }\n    this.change(this.value)\n  \n  }\n\n}"],"sourceRoot":""}